/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,n,t){e.exports=t.p+"7e68e84774d219c9c3b1.css"}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var o=n[a]={exports:{}};return e[a](o,o.exports,t),o.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var a=n.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=a[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach(function(n){c(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function s(t,a,r,o){var s=a&&a.prototype instanceof c?a:c,l=Object.create(s.prototype);return i(l,"_invoke",function(t,a,r){var o,i,s,c=0,l=r||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,i=0,s=e,d.n=t,u}};function f(t,a){for(i=t,s=a,n=0;!m&&c&&!r&&n<l.length;n++){var r,o=l[n],f=d.p,p=o[2];t>3?(r=p===a)&&(s=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=t<2&&f<o[1])?(i=0,d.v=a,d.n=o[1]):f<p&&(r=t<3||o[0]>a||a>p)&&(o[4]=t,o[5]=a,d.n=p,i=0))}if(r||t>1)return u;throw m=!0,a}return function(r,l,p){if(c>1)throw TypeError("Generator is already running");for(m&&1===l&&f(l,p),i=l,s=p;(n=i<2?e:s)||!m;){o||(i?i<3?(i>1&&(d.n=-1),f(i,s)):d.n=s:d.v=s);try{if(c=2,o){if(i||(r="next"),n=o[r]){if(!(n=n.call(o,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,i<2&&(i=0)}else 1===i&&(n=o.return)&&n.call(o),i<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((n=(m=d.n<0)?s:t.call(a,d))!==u)break}catch(n){o=e,i=1,s=n}finally{c=1}}return{value:n,done:m}}}(t,r,o),!0),l}var u={};function c(){}function l(){}function m(){}n=Object.getPrototypeOf;var d=[][a]?n(n([][a]())):(i(n={},a,function(){return this}),n),f=m.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,i(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=m,i(f,"constructor",m),i(m,"constructor",l),l.displayName="GeneratorFunction",i(m,r,"GeneratorFunction"),i(f),i(f,r,"Generator"),i(f,a,function(){return this}),i(f,"toString",function(){return"[object Generator]"}),(o=function(){return{w:s,m:p}})()}function i(e,n,t,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}i=function(e,n,t,a){function o(n,t){i(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},i(e,n,t,a)}function s(e,n,t,a,r,o,i){try{var s=e[o](i),u=s.value}catch(e){return void t(e)}s.done?n(u):Promise.resolve(u).then(a,r)}function u(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l(a.key),a)}}function c(e,n,t){return(n=l(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var a=t.call(n,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var m=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"remunerationData",[]),c(this,"referenceRenumeration",null),c(this,"isLoaded",!1)},t=[{key:"loadData",value:(a=o().m(function e(){var n,t,a;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isLoaded){e.n=1;break}return e.a(2);case 1:return e.p=1,console.log("Loading remuneration data from JSON file..."),e.n=2,fetch("./assets/renumerations-export.json");case 2:if((n=e.v).ok){e.n=3;break}throw new Error("Failed to load data: ".concat(n.status," ").concat(n.statusText));case 3:return e.n=4,n.json();case 4:return this.remunerationData=e.v,console.log("Remunerations loaded"),e.n=5,fetch("./assets/reference-renumeration.json");case 5:if((t=e.v).ok){e.n=6;break}throw new Error("Failed to load reference data: ".concat(t.status," ").concat(t.statusText));case 6:return e.n=7,t.json();case 7:this.referenceRenumeration=e.v,console.log("Reference remuneration data loaded"),this.isLoaded=!0,console.log("Loaded ".concat(this.remunerationData.length," remuneration records")),e.n=9;break;case 8:throw e.p=8,a=e.v,console.error("Error loading remuneration data:",a),new Error("Failed to load remuneration data: ".concat(a.message));case 9:return e.a(2)}},e,this,[[1,8]])}),i=function(){var e=this,n=arguments;return new Promise(function(t,r){var o=a.apply(e,n);function i(e){s(o,t,r,i,u,"next",e)}function u(e){s(o,t,r,i,u,"throw",e)}i(void 0)})},function(){return i.apply(this,arguments)})},{key:"getPartners",value:function(){if(!this.isLoaded)return console.warn("Data not loaded yet. Call loadData() first."),[];var e=new Map;this.remunerationData.forEach(function(n){n.company&&n.company.id&&n.company.businessName&&e.set(n.company.id,{id:n.company.id,businessName:n.company.businessName})});var n=Array.from(e.values());return console.log("Found ".concat(n.length," unique partners")),n.sort(function(e,n){return e.businessName.localeCompare(n.businessName)})}},{key:"getPartnerRemuneration",value:function(e){if(!this.isLoaded)return console.warn("Data not loaded yet. Call loadData() first."),[];var n=this.remunerationData.filter(function(n){return n.company&&n.company.id===e});return console.log("Found ".concat(n.length," remuneration records for partner: ").concat(e)),n}},{key:"getReferenceRemuneration",value:function(){return this.isLoaded?this.referenceRenumeration?this.referenceRenumeration:(console.warn("Reference remuneration data not loaded."),null):(console.warn("Data not loaded yet. Call loadData() first."),null)}},{key:"formatAmountDisplay",value:function(e,n){return e?"".concat(e).concat("Percentage"===(null==n?void 0:n.value)?"%":""):"N/A"}},{key:"mapCodeToComponent",value:function(e){switch(e){case"CAOAllowances":return"allowances";case"CAOHolidayAllowance":return"holidayAllowance";case"CAOOneTimePayment":return"oneTimePayment";case"CAOFixedPayment":return"fixedPayment";case"CAOVariablePayment":return"variablePayment";case"CAOHoliday":return"holiday";case"CAOWageTable":return"wageTable";case"CAOWageIncrement":return"wageIncrement";case"CAOPeriodicIncrement":return"periodicIncrement";case"CAORetroactiveIncrement":return"retroactiveIncrement";case"CAOTravelExpenses":return"travelExpenses";case"CAOTravelTime":return"travelTime";case"Other":return"other";default:return"unknown"}}},{key:"enhancePensionableEarningsWithComponents",value:function(e){var n=this;return e.map(function(e){return r(r({},e),{},{component:n.mapCodeToComponent(e.code)})})}},{key:"generateDataWithStandardStructure",value:function(e,t,a,r){var o=this.getPartnerRemuneration(e),i=Array(a.length).fill("").map(function(e,n){return 0===n?t:""});if(!o||0===o.length)return[i];var s=[];s.push(a);var u=r(o);return s.push.apply(s,n(u)),1===s.length&&s.push(i),s}},{key:"generateMetadata",value:function(e){var n=this.getPartnerRemuneration(e);if(!n||0===n.length)return[["Metadata","",""],["Partner Name","No data available",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]];var t=n[0],a=t.company,r=t.workingHours;return[["ILB Remuneration Data","",""],["Partner Name",(null==a?void 0:a.businessName)||"Unknown",""],["Commerce Number",(null==a?void 0:a.commerceNumber)||"N/A",""],["Version","".concat(t.lenderVersion,"/").concat(t.totalVersions),""],["Start Date",t.startDate||"N/A",""],["Publish Date",t.publishDate||"N/A",""],["Full Time Hours",(null==r?void 0:r.fullTimeHours)||"N/A",(null==r?void 0:r.fullTimeHoursPer)||""],["Working Hours Comments",(null==r?void 0:r.workingHoursComments)||"N/A",""],["","",""],["Remuneration Components:","",""]]}},{key:"generateHolidayAllowances",value:function(e){var n=this,t=this.getPartnerRemuneration(e),a=["No holiday allowances data available","","","","","","","",""];if(!t||0===t.length)return[a];var r=[],o=this.getPensionableComponents(e).some(function(e){return"CAOHolidayAllowance"===e.code});return r.push(["Allowance Name","Amount","Amount Type","Interval","Based On","Individual Choice Budget","Pensionable","Conditions","Description"]),t.forEach(function(e){e.holidayAllowances&&e.holidayAllowances.length>0&&e.holidayAllowances.forEach(function(e){var t,a=n.formatAmountDisplay(e.amount,e.amountType);r.push(["Holiday Allowance",a,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A",e.basedOn||"N/A",e.isPartOfIndividualChoiceBudget?"true":"",o?"true":"","N/A",e.description||"N/A"])})}),1===r.length&&r.push(a),r}},{key:"generateAllowances",value:function(e){var n=this,t=this.getPartnerRemuneration(e),a=["No allowances data available","","","","","","","",""];if(!t||0===t.length)return[a];var r=[],o=this.getPensionableComponents(e).some(function(e){return"CAOAllowances"===e.code});return r.push(["Allowance Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"]),t.forEach(function(e){e.allowances&&e.allowances.hasAllowances&&e.allowances.allowances&&e.allowances.allowances.forEach(function(e){var t=e.name||e.typeTitle||"Unnamed Allowance";e.allowanceComponents&&e.allowanceComponents.length>0?e.allowanceComponents.forEach(function(e){var a,i=n.formatAmountDisplay(e.amount,e.amountType);r.push([t,i,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","",o?"true":"",e.conditions||"N/A",e.description||"N/A"])}):r.push([t,"N/A","N/A","N/A","N/A","",o?"true":"",e.conditions||"N/A","No components available"])})}),1===r.length&&r.push(a),console.log(r),r}},{key:"generateTravelExpensesData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No travel expenses data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(t){var a=[],r=n.getPensionableComponents(e).some(function(e){return"CAOTravelExpenses"===e.code||"CAOTravelTime"===e.code});return t.forEach(function(e){e.travelExpensesData&&e.travelExpensesData.hasTravelExpenses&&e.travelExpensesData.travelExpenses&&e.travelExpensesData.travelExpenses.forEach(function(e){var t,o=(null===(t=e.compensationType)||void 0===t?void 0:t.value)||"Unknown";e.components&&e.components.length>0?e.components.forEach(function(e){var t,i,s=n.formatAmountDisplay(e.amount,e.amountType),u="Travel Expense";if("Hours"===(null===(t=e.amountType)||void 0===t?void 0:t.value))u="Travel Time";else if("Money"===o)u="Travel Allowance";else if("Both"===o){var c;u="Hours"===(null===(c=e.amountType)||void 0===c?void 0:c.value)?"Travel Time":"Travel Allowance"}a.push([u,s,(null===(i=e.amountType)||void 0===i?void 0:i.value)||"N/A",o||"N/A",e.interval||"N/A","",r?"true":"",e.conditions||"N/A",e.description||"N/A"])}):a.push(["Travel Expense","N/A","N/A",o||"N/A","N/A","",r?"true":"","N/A","Travel expense with ".concat(o," compensation")])})}),a})}},{key:"generateWageIncrementsData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No wage increments data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.wageIncrements&&e.wageIncrements.hasWageIncrements&&(e.wageIncrements.incrementData&&e.wageIncrements.incrementData.length>0&&e.wageIncrements.incrementData.forEach(function(e){var a=n.formatAmountDisplay(e.percentage,{value:"%"===e.incrementType?"Percentage":"Amount",otherValue:null});t.push(["Regular Wage Increment",a,"%"===e.incrementType?"Percentage":"Amount","Salary","Effective ".concat(e.date),"","",e.appliesToAllFunctions?"Applies to all functions":"Function-specific",e.explanation||"Wage increment of ".concat(e.percentage).concat(e.incrementType," effective ").concat(e.date)])}),e.wageIncrements.retroactiveIncrementData&&e.wageIncrements.retroactiveIncrementData.length>0&&e.wageIncrements.retroactiveIncrementData.forEach(function(e){var a=n.formatAmountDisplay(e.percentage,{value:"%"===e.incrementType?"Percentage":"Amount",otherValue:null});t.push(["Retroactive Wage Increment",a,"%"===e.incrementType?"Percentage":"Amount","Salary","Effective ".concat(e.date),"","",e.appliesToAllFunctions?"Applies to all functions":"Function-specific",e.explanation||"Retroactive wage increment of ".concat(e.percentage).concat(e.incrementType," effective ").concat(e.date)])}),e.wageIncrements.periodicalData&&e.wageIncrements.periodicalData.length>0&&e.wageIncrements.periodicalData.forEach(function(e){t.push(["Periodical Increment","N/A","Schedule-based","Performance & Experience","".concat(e.experiencePeriodAmount," ").concat(e.experiencePeriodAmountType),"","","".concat(e.eligibleType," - ").concat(e.performanceMoment),e.periodicals||"Performance-based salary progression"])}))}),t})}},{key:"getPensionableComponents",value:function(e){var t=this.getPartnerRemuneration(e),a=t.length>0?t[0].pensionData:null;if(!a||!a.items||0===a.items.length)return[];var r=[];return a.items.forEach(function(e){e.pensionableEarnings&&e.pensionableEarnings.length>0&&r.push.apply(r,n(e.pensionableEarnings))}),this.enhancePensionableEarningsWithComponents(r)}},{key:"generatePensionData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No pension data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.pensionData&&e.pensionData.hasPension&&e.pensionData.items&&e.pensionData.items.forEach(function(e){var a,r=n.formatAmountDisplay(e.amount,e.amountType),o=e.pensionableEarnings&&e.pensionableEarnings.length>0?e.pensionableEarnings.map(function(e){return e.title}).join(", "):"N/A";t.push(["Pension",r,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",o||"N/A",e.interval||"N/A","","","N/A",e.description||"N/A"])})}),t})}},{key:"generateLeaveData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No leave data available",["Leave Type","Amount","Amount Type","Interval","Based On","Individual Choice Budget","Pensionable","Conditions","Description"],function(t){var a=[],r=n.getPensionableComponents(e).some(function(e){return"CAOHoliday"===e.code}),o=function(e,t){e.forEach(function(e){var o,i=n.formatAmountDisplay(e.amount,e.amountType);a.push([t,i,(null===(o=e.amountType)||void 0===o?void 0:o.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"",r?"true":"",e.conditions||"N/A",e.description||"N/A"])})};return t.forEach(function(e){if(e.leave){var n=e.leave;n.hasWorkingHoursReduction&&n.workingHoursReductions&&o(n.workingHoursReductions,"Working Hours Reduction"),n.hasVacationDays&&n.vacationDays&&o(n.vacationDays,"Vacation Days"),n.hasSpecialLeave&&n.specialLeave&&o(n.specialLeave,"Special Leave"),n.hasAdditionalWAZO&&n.additionalWAZO&&o(n.additionalWAZO,"Additional WAZO"),n.hasMandatoryLeave&&n.mandatoryLeave&&o(n.mandatoryLeave,"Mandatory Leave")}}),a})}},{key:"generateSickPayData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No sick pay data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.sickPay&&e.sickPay.sickPayAmounts&&Array.isArray(e.sickPay.sickPayAmounts)&&e.sickPay.sickPayAmounts.length>0&&e.sickPay.sickPayAmounts.forEach(function(e){var a,r,o=n.formatAmountDisplay(e.amount,e.amountType);t.push(["Sick Pay (".concat((null===(a=e.sickPayYear)||void 0===a?void 0:a.value)||"Unknown Year",")"),o,(null===(r=e.amountType)||void 0===r?void 0:r.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","","N/A","N/A"])})}),t})}},{key:"generateIndividualChoiceBudget",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No individual choice budget data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){if(e.individualChoiceBudget&&e.individualChoiceBudget.hasIndividualChoiceBudget){var a,r=e.individualChoiceBudget,o=n.formatAmountDisplay(r.amount,r.amountType);t.push(["Individual Choice Budget",o,(null===(a=r.amountType)||void 0===a?void 0:a.value)||"N/A",r.basedOn||"N/A",r.interval||"N/A","true","","N/A","Main budget allocation"]),r.items&&r.items.length>0&&r.items.forEach(function(e){var a,r=n.formatAmountDisplay(e.amount,e.amountType),o="Other"===e.name&&e.typeOther?e.typeOther:e.name||"Unnamed Component";t.push([o,r,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"","","N/A",e.description||"N/A"])})}}),t})}},{key:"generateReimbursementsData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No reimbursements data available",["Reimbursement Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.reimbursementsData&&e.reimbursementsData.hasReimbursements&&e.reimbursementsData.reimbursements&&e.reimbursementsData.reimbursements.forEach(function(e){var a,r=n.formatAmountDisplay(e.amount,e.amountType);t.push([e.name||"Unnamed Reimbursement",r,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","",e.conditions||"N/A",e.description||"N/A"])})}),t})}},{key:"generatePaymentsData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No payments data available",["Payment Type","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(t){var a=[],r=n.getPensionableComponents(e),o=r.some(function(e){return"CAOFixedPayment"===e.code}),i=r.some(function(e){return"CAOOneTimePayment"===e.code}),s=r.some(function(e){return"CAOVariablePayment"===e.code});return t.forEach(function(e){e.paymentsData&&(e.paymentsData.hasFixedPayments&&e.paymentsData.fixedPayments&&e.paymentsData.fixedPayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType),i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A";a.push(["Fixed Payment",r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",i,e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"",o?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.paymentsData.hasOneTimePayments&&e.paymentsData.oneTimePayments&&e.paymentsData.oneTimePayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType),o="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A";a.push(["One-Time Payment",r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",o,e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"",i?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.paymentsData.hasVariablePayments&&e.paymentsData.variablePayments&&e.paymentsData.variablePayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType);if(e.hasMinMaxAmount&&(null!==e.minAmount||null!==e.maxAmount)){var o=[null!==e.minAmount?"Min: ".concat(e.minAmount):"",null!==e.maxAmount?"Max: ".concat(e.maxAmount):""].filter(Boolean).join(", ");o&&(r+=" (".concat(o,")"))}var i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",u=e.name?"Variable Payment (".concat(e.name,")"):"Variable Payment";a.push([u,r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",i,e.interval||"N/A","",s?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.paymentsData.hasAnniversaryPayments&&e.paymentsData.anniversaryPayments&&e.paymentsData.anniversaryPayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType),o="Anniversary Payment (".concat(e.amountOfYears," years)"),i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",s="Other"===e.dateOrCondition&&e.dateOrConditionOther?e.dateOrConditionOther:e.dateOrCondition||"N/A";a.push([o,r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",i,e.interval||"N/A","","",s,e.description||"N/A"])}))}),a})}},{key:"extractAllPensionableEarnings",value:function(e){if(!e||!e.items||0===e.items.length)return[];var t=[];return e.items.forEach(function(e){e.pensionableEarnings&&e.pensionableEarnings.length>0&&t.push.apply(t,n(e.pensionableEarnings))}),this.enhancePensionableEarningsWithComponents(t)}},{key:"getPensionableComponentTypes",value:function(e){return this.getPensionableComponents(e).map(function(e){return e.component}).filter(function(e,n,t){return e&&t.indexOf(e)===n})}},{key:"isComponentTypePensionable",value:function(e,n){return this.getPensionableComponentTypes(e).includes(n)}},{key:"generateEPModel",value:function(e){var n,t,a,r,o,i,s,u,c,l,m=this,d=this.getPartnerRemuneration(e),f=this.getReferenceRemuneration();if(!d||0===d.length||!f)return{error:"Missing partner or reference data",partnerData:(null==d?void 0:d.length)||0,referenceData:f?1:0};var p=d[0],v=f,y=function(e,n,t,a){return{componentType:t,partner:{hasData:!!e,rows:e?a(e,!1):[]},reference:{hasData:!!n,rows:n?a(n,!0):[]}}};return{metadata:{partner:{businessName:(null===(n=p.company)||void 0===n?void 0:n.businessName)||"Unknown",commerceNumber:(null===(t=p.company)||void 0===t?void 0:t.commerceNumber)||"N/A",startDate:p.startDate,publishDate:p.publishDate},reference:{businessName:(null===(a=v.company)||void 0===a?void 0:a.businessName)||"Reference Company",commerceNumber:(null===(r=v.company)||void 0===r?void 0:r.commerceNumber)||"REF",startDate:v.startDate,publishDate:v.publishDate}},workingHours:{partner:{fullTimeHours:(null===(o=p.workingHours)||void 0===o?void 0:o.fullTimeHours)||"N/A",fullTimeHoursPer:(null===(i=p.workingHours)||void 0===i?void 0:i.fullTimeHoursPer)||"N/A",comments:(null===(s=p.workingHours)||void 0===s?void 0:s.workingHoursComments)||"N/A"},reference:{fullTimeHours:(null===(u=v.workingHours)||void 0===u?void 0:u.fullTimeHours)||"N/A",fullTimeHoursPer:(null===(c=v.workingHours)||void 0===c?void 0:c.fullTimeHoursPer)||"N/A",comments:(null===(l=v.workingHours)||void 0===l?void 0:l.workingHoursComments)||"N/A"}},allowances:y(p.allowances,v.allowances,"allowances",function(n,t){return m.generateAllowancesForComparison(n,t?"REF":e)}),holidayAllowances:y(p.holidayAllowances,v.holidayAllowances,"holidayAllowances",function(n,t){return m.generateHolidayAllowancesForComparison(n,t?"REF":e)}),pensionData:y(p.pensionData,v.pensionData,"pensionData",function(n,t){return m.generatePensionDataForComparison(n,t?"REF":e)}),leave:y(p.leave,v.leave,"leave",function(n,t){return m.generateLeaveDataForComparison(n,t?"REF":e)}),sickPay:y(p.sickPay,v.sickPay,"sickPay",function(n,t){return m.generateSickPayDataForComparison(n,t?"REF":e)}),individualChoiceBudget:y(p.individualChoiceBudget,v.individualChoiceBudget,"individualChoiceBudget",function(n,t){return m.generateIndividualChoiceBudgetForComparison(n,t?"REF":e)}),reimbursementsData:y(p.reimbursementsData,v.reimbursementsData,"reimbursementsData",function(n,t){return m.generateReimbursementsDataForComparison(n,t?"REF":e)}),paymentsData:y(p.paymentsData,v.paymentsData,"paymentsData",function(n,t){return m.generatePaymentsDataForComparison(n,t?"REF":e)}),wageIncrements:y(p.wageIncrements,v.wageIncrements,"wageIncrements",function(n,t){return m.generateWageIncrementsDataForComparison(n,t?"REF":e)}),travelExpensesData:y(p.travelExpensesData,v.travelExpensesData,"travelExpensesData",function(n,t){return m.generateTravelExpensesDataForComparison(n,t?"REF":e)})}}},{key:"generateAllowancesForComparison",value:function(e,n){var t=this;if(!e||!e.hasAllowances||!e.allowances)return[["No allowances data available","","","","","","","",""]];var a=[],r=("REF"===n?[]:this.getPensionableComponents(n)).some(function(e){return"CAOAllowances"===e.code});return e.allowances.forEach(function(e){var o=e.name||e.typeTitle||"Unnamed Allowance";e.allowanceComponents&&e.allowanceComponents.length>0?e.allowanceComponents.forEach(function(e){var i,s=t.formatAmountDisplay(e.amount,e.amountType);a.push([o,s,(null===(i=e.amountType)||void 0===i?void 0:i.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","REF"===n?"":r?"true":"",e.conditions||"N/A",e.description||"N/A"])}):a.push([o,"N/A","N/A","N/A","N/A","","REF"===n?"":r?"true":"",e.conditions||"N/A","No components available"])}),a}},{key:"generateHolidayAllowancesForComparison",value:function(e,n){var t=this;if(!e||0===e.length)return[["No holiday allowances data available","","","","","","","",""]];var a=[],r=("REF"===n?[]:this.getPensionableComponents(n)).some(function(e){return"CAOHolidayAllowance"===e.code});return e.forEach(function(e){var o,i=t.formatAmountDisplay(e.amount,e.amountType);a.push(["Holiday Allowance",i,(null===(o=e.amountType)||void 0===o?void 0:o.value)||"N/A",e.interval||"N/A",e.basedOn||"N/A",e.isPartOfIndividualChoiceBudget?"true":"","REF"===n?"":r?"true":"","N/A",e.description||"N/A"])}),a}},{key:"generatePensionDataForComparison",value:function(e,n){var t=this;if(!e||!e.hasPension||!e.items)return[["No pension data available","","","","","","","",""]];var a=[];return e.items.forEach(function(e){var n,r=t.formatAmountDisplay(e.amount,e.amountType),o=e.pensionableEarnings&&e.pensionableEarnings.length>0?e.pensionableEarnings.map(function(e){return e.title}).join(", "):"N/A";a.push(["Pension",r,(null===(n=e.amountType)||void 0===n?void 0:n.value)||"N/A",o||"N/A",e.interval||"N/A","","","N/A",e.description||"N/A"])}),a}},{key:"generateLeaveDataForComparison",value:function(e,n){var t=this;if(!e)return[["No leave data available","","","","","","","",""]];var a=[],r=("REF"===n?[]:this.getPensionableComponents(n)).some(function(e){return"CAOHoliday"===e.code}),o=function(e,o){e&&e.forEach(function(e){var i,s=t.formatAmountDisplay(e.amount,e.amountType);a.push([o,s,(null===(i=e.amountType)||void 0===i?void 0:i.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"","REF"===n?"":r?"true":"",e.conditions||"N/A",e.description||"N/A"])})};return e.hasWorkingHoursReduction&&o(e.workingHoursReductions,"Working Hours Reduction"),e.hasVacationDays&&o(e.vacationDays,"Vacation Days"),e.hasSpecialLeave&&o(e.specialLeave,"Special Leave"),e.hasAdditionalWAZO&&o(e.additionalWAZO,"Additional WAZO"),e.hasMandatoryLeave&&o(e.mandatoryLeave,"Mandatory Leave"),0===a.length&&a.push(["No leave components available","","","","","","","",""]),a}},{key:"generateSickPayDataForComparison",value:function(e,n){var t=this;if(!e||!e.sickPayAmounts||0===e.sickPayAmounts.length)return[["No sick pay data available","","","","","","","",""]];var a=[];return e.sickPayAmounts.forEach(function(e){var n,r,o=t.formatAmountDisplay(e.amount,e.amountType);a.push(["Sick Pay (".concat((null===(n=e.sickPayYear)||void 0===n?void 0:n.value)||"Unknown Year",")"),o,(null===(r=e.amountType)||void 0===r?void 0:r.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","","N/A","N/A"])}),a}},{key:"generateIndividualChoiceBudgetForComparison",value:function(e,n){var t,a=this;if(!e||!e.hasIndividualChoiceBudget)return[["No individual choice budget data available","","","","","","","",""]];var r=[],o=this.formatAmountDisplay(e.amount,e.amountType);return r.push(["Individual Choice Budget",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","true","","N/A","Main budget allocation"]),e.items&&e.items.length>0&&e.items.forEach(function(e){var n,t=a.formatAmountDisplay(e.amount,e.amountType),o="Other"===e.name&&e.typeOther?e.typeOther:e.name||"Unnamed Component";r.push([o,t,(null===(n=e.amountType)||void 0===n?void 0:n.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"","","N/A",e.description||"N/A"])}),r}},{key:"generateReimbursementsDataForComparison",value:function(e,n){var t=this;if(!e||!e.hasReimbursements||!e.reimbursements)return[["No reimbursements data available","","","","","","","",""]];var a=[];return e.reimbursements.forEach(function(e){var n,r=t.formatAmountDisplay(e.amount,e.amountType);a.push([e.name||"Unnamed Reimbursement",r,(null===(n=e.amountType)||void 0===n?void 0:n.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","",e.conditions||"N/A",e.description||"N/A"])}),a}},{key:"generatePaymentsDataForComparison",value:function(e,n){var t=this;if(!e)return[["No payments data available","","","","","","","",""]];var a=[],r="REF"===n?[]:this.getPensionableComponents(n),o=r.some(function(e){return"CAOFixedPayment"===e.code}),i=r.some(function(e){return"CAOOneTimePayment"===e.code}),s=r.some(function(e){return"CAOVariablePayment"===e.code});return e.hasFixedPayments&&e.fixedPayments&&e.fixedPayments.forEach(function(e){var r,i=t.formatAmountDisplay(e.amount,e.amountType),s="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A";a.push(["Fixed Payment",i,(null===(r=e.amountType)||void 0===r?void 0:r.value)||"N/A",s,e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"","REF"===n?"":o?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.hasOneTimePayments&&e.oneTimePayments&&e.oneTimePayments.forEach(function(e){var r,o=t.formatAmountDisplay(e.amount,e.amountType),s="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A";a.push(["One-Time Payment",o,(null===(r=e.amountType)||void 0===r?void 0:r.value)||"N/A",s,e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"","REF"===n?"":i?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.hasVariablePayments&&e.variablePayments&&e.variablePayments.forEach(function(e){var r,o=t.formatAmountDisplay(e.amount,e.amountType);if(e.hasMinMaxAmount&&(null!==e.minAmount||null!==e.maxAmount)){var i=[null!==e.minAmount?"Min: ".concat(e.minAmount):"",null!==e.maxAmount?"Max: ".concat(e.maxAmount):""].filter(Boolean).join(", ");i&&(o+=" (".concat(i,")"))}var u="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",c=e.name?"Variable Payment (".concat(e.name,")"):"Variable Payment";a.push([c,o,(null===(r=e.amountType)||void 0===r?void 0:r.value)||"N/A",u,e.interval||"N/A","","REF"===n?"":s?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.hasAnniversaryPayments&&e.anniversaryPayments&&e.anniversaryPayments.forEach(function(e){var n,r=t.formatAmountDisplay(e.amount,e.amountType),o="Anniversary Payment (".concat(e.amountOfYears," years)"),i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",s="Other"===e.dateOrCondition&&e.dateOrConditionOther?e.dateOrConditionOther:e.dateOrCondition||"N/A";a.push([o,r,(null===(n=e.amountType)||void 0===n?void 0:n.value)||"N/A",i,e.interval||"N/A","","",s,e.description||"N/A"])}),0===a.length&&a.push(["No payments available","","","","","","","",""]),a}},{key:"generateWageIncrementsDataForComparison",value:function(e,n){var t=this;if(!e||!e.hasWageIncrements)return[["No wage increments data available","","","","","","","",""]];var a=[];return e.incrementData&&e.incrementData.length>0&&e.incrementData.forEach(function(e){var n=t.formatAmountDisplay(e.percentage,{value:"%"===e.incrementType?"Percentage":"Amount",otherValue:null});a.push(["Regular Wage Increment",n,"%"===e.incrementType?"Percentage":"Amount","Salary","Effective ".concat(e.date),"","",e.appliesToAllFunctions?"Applies to all functions":"Function-specific",e.explanation||"Wage increment of ".concat(e.percentage).concat(e.incrementType," effective ").concat(e.date)])}),e.retroactiveIncrementData&&e.retroactiveIncrementData.length>0&&e.retroactiveIncrementData.forEach(function(e){var n=t.formatAmountDisplay(e.percentage,{value:"%"===e.incrementType?"Percentage":"Amount",otherValue:null});a.push(["Retroactive Wage Increment",n,"%"===e.incrementType?"Percentage":"Amount","Salary","Effective ".concat(e.date),"","",e.appliesToAllFunctions?"Applies to all functions":"Function-specific",e.explanation||"Retroactive wage increment of ".concat(e.percentage).concat(e.incrementType," effective ").concat(e.date)])}),e.periodicalData&&e.periodicalData.length>0&&e.periodicalData.forEach(function(e){a.push(["Periodical Increment","N/A","Schedule-based","Performance & Experience","".concat(e.experiencePeriodAmount," ").concat(e.experiencePeriodAmountType),"","","".concat(e.eligibleType," - ").concat(e.performanceMoment),e.periodicals||"Performance-based salary progression"])}),0===a.length&&a.push(["No wage increment components available","","","","","","","",""]),a}},{key:"generateTravelExpensesDataForComparison",value:function(e,n){var t=this;if(!e||!e.hasTravelExpenses||!e.travelExpenses)return[["No travel expenses data available","","","","","","","",""]];var a=[],r=("REF"===n?[]:this.getPensionableComponents(n)).some(function(e){return"CAOTravelExpenses"===e.code||"CAOTravelTime"===e.code});return e.travelExpenses.forEach(function(e){var o,i=(null===(o=e.compensationType)||void 0===o?void 0:o.value)||"Unknown";e.components&&e.components.length>0?e.components.forEach(function(e){var o,s,u=t.formatAmountDisplay(e.amount,e.amountType),c="Travel Expense";if("Hours"===(null===(o=e.amountType)||void 0===o?void 0:o.value))c="Travel Time";else if("Money"===i)c="Travel Allowance";else if("Both"===i){var l;c="Hours"===(null===(l=e.amountType)||void 0===l?void 0:l.value)?"Travel Time":"Travel Allowance"}a.push([c,u,(null===(s=e.amountType)||void 0===s?void 0:s.value)||"N/A",i||"N/A",e.interval||"N/A","","REF"===n?"":r?"true":"",e.conditions||"N/A",e.description||"N/A"])}):a.push(["Travel Expense","N/A","N/A",i||"N/A","N/A","","REF"===n?"":r?"true":"","N/A","Travel expense with ".concat(i," compensation")])}),a}}],t&&u(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a,i}(),d=new m;function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=v(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(s)throw o}}}}function v(e,n){if(e){if("string"==typeof e)return y(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,n):void 0}}function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function h(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function o(t,a,r,o){var u=a&&a.prototype instanceof s?a:s,c=Object.create(u.prototype);return g(c,"_invoke",function(t,a,r){var o,s,u,c=0,l=r||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,s=0,u=e,d.n=t,i}};function f(t,a){for(s=t,u=a,n=0;!m&&c&&!r&&n<l.length;n++){var r,o=l[n],f=d.p,p=o[2];t>3?(r=p===a)&&(u=o[(s=o[4])?5:(s=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=t<2&&f<o[1])?(s=0,d.v=a,d.n=o[1]):f<p&&(r=t<3||o[0]>a||a>p)&&(o[4]=t,o[5]=a,d.n=p,s=0))}if(r||t>1)return i;throw m=!0,a}return function(r,l,p){if(c>1)throw TypeError("Generator is already running");for(m&&1===l&&f(l,p),s=l,u=p;(n=s<2?e:u)||!m;){o||(s?s<3?(s>1&&(d.n=-1),f(s,u)):d.n=u:d.v=u);try{if(c=2,o){if(s||(r="next"),n=o[r]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,s<2&&(s=0)}else 1===s&&(n=o.return)&&n.call(o),s<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),s=1);o=e}else if((n=(m=d.n<0)?u:t.call(a,d))!==i)break}catch(n){o=e,s=1,u=n}finally{c=1}}return{value:n,done:m}}}(t,r,o),!0),c}var i={};function s(){}function u(){}function c(){}n=Object.getPrototypeOf;var l=[][a]?n(n([][a]())):(g(n={},a,function(){return this}),n),m=c.prototype=s.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,g(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return u.prototype=c,g(m,"constructor",c),g(c,"constructor",u),u.displayName="GeneratorFunction",g(c,r,"GeneratorFunction"),g(m),g(m,r,"Generator"),g(m,a,function(){return this}),g(m,"toString",function(){return"[object Generator]"}),(h=function(){return{w:o,m:d}})()}function g(e,n,t,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}g=function(e,n,t,a){function o(n,t){g(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},g(e,n,t,a)}function b(e,n,t,a,r,o,i){try{var s=e[o](i),u=s.value}catch(e){return void t(e)}s.done?n(u):Promise.resolve(u).then(a,r)}function A(e){return function(){var n=this,t=arguments;return new Promise(function(a,r){var o=e.apply(n,t);function i(e){b(o,a,r,i,s,"next",e)}function s(e){b(o,a,r,i,s,"throw",e)}i(void 0)})}}var N=[],P="";function w(){return D.apply(this,arguments)}function D(){return(D=A(h().m(function e(){var n,t;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Starting to load partners..."),U("Loading partners from JSON data...","loading"),e.p=1,e.n=2,d.loadData();case 2:N=d.getPartners(),console.log("Partners loaded:",N),(n=document.getElementById("partner-select"))&&(n.innerHTML='<option value="">Select a partner...</option>',N.forEach(function(e){console.log("Adding partner to dropdown:",e);var t=document.createElement("option");t.value=e.id,t.textContent=e.businessName,n.appendChild(t)}),n.disabled=!1),U("Loaded ".concat(N.length," partners"),"success"),e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error loading partners:",t),U("Error loading partners: ".concat(t.message),"error");case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function O(){var e=document.getElementById("partner-select");if(e){P=e.value;var n=document.getElementById("load-remuneration");if(n&&(P?n.classList.remove("disabled"):n.classList.add("disabled")),P){var t=N.find(function(e){return e.id===P});U("Selected partner: ".concat((null==t?void 0:t.businessName)||P),"success")}else U("Select a partner to continue","loading")}}function E(){return T.apply(this,arguments)}function T(){return T=A(h().m(function e(){var n,t,a,r,o;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!(n=document.getElementById("load-remuneration"))||!n.classList.contains("disabled")){e.n=1;break}return e.a(2);case 1:if(P){e.n=2;break}return U("Please select a partner first","error"),e.a(2);case 2:if(t=N.find(function(e){return e.id===P}),U("Loading remuneration and allowances for ".concat(null==t?void 0:t.businessName,"..."),"loading"),e.p=3,(a=d.getPartnerRemuneration(P))&&0!==a.length){e.n=4;break}return U("No remuneration available for this partner","error"),e.a(2);case 4:return e.n=5,Excel.run(function(){var e=A(h().m(function e(n){return h().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,x(n,P,(null==t?void 0:t.businessName)||"Unknown");case 1:U("Remuneration and allowances loaded successfully for ".concat(null==t?void 0:t.businessName," (").concat(a.length," records)"),"success");case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 5:e.n=7;break;case 6:e.p=6,o=e.v,console.error("Error loading remuneration:",o),U("Error loading remuneration: ".concat(o.message),"error");case 7:(r=document.getElementById("generate-ep-sheet"))&&r.classList.remove("disabled");case 8:return e.a(2)}},e,null,[[3,6]])})),T.apply(this,arguments)}function k(){return C.apply(this,arguments)}function C(){return C=A(h().m(function e(){var n,t;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(P){e.n=1;break}return U("Please select a partner first","error"),e.a(2);case 1:return n=N.find(function(e){return e.id===P}),U("Generating equal pay sheet for ".concat(null==n?void 0:n.businessName,"..."),"loading"),e.p=2,e.n=3,Excel.run(function(){var e=A(h().m(function e(t){return h().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,I(t,P,(null==n?void 0:n.businessName)||"Unknown");case 1:U("Equal pay sheet generated successfully for ".concat(null==n?void 0:n.businessName),"success");case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 3:e.n=5;break;case 4:e.p=4,t=e.v,console.error("Error generating equal pay sheet:",t),U("Error generating equal pay sheet: ".concat(t.message),"error");case 5:return e.a(2)}},e,null,[[2,4]])})),C.apply(this,arguments)}function I(e,n,t){return R.apply(this,arguments)}function R(){return(R=A(h().m(function e(n,t,a){var r,o,i,s,u,c,l,m,f,p,v,y,g,b,A,N,P,w,D,O,E,T,k;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Preparing to generate EP sheet for partner ID: ".concat(t)),e.p=1,r=n.workbook.worksheets.getItem("EP"),e.n=2,n.sync();case 2:console.log("EP worksheet found."),r.getUsedRange().clear(),e.n=4;break;case 3:return e.p=3,e.v,console.log("EP worksheet not found, creating a new one."),r=n.workbook.worksheets.add("EP"),e.n=4,n.sync();case 4:return r.activate(),e.n=5,n.sync();case 5:if(console.log("Generating EP data for partner: ".concat(a)),!(o=d.generateEPModel(t)).error){e.n=7;break}return console.error("Error generating EP model:",o.error),(i=r.getRange("A1:B1")).values=[["Error",o.error]],i.format.font.color="red",e.n=6,n.sync();case 6:return e.a(2);case 7:return console.log("EP model generated:",o),s=[["Equal Pay Analysis","","","Partner Data","","","Reference Data","",""],["","","","","","","","",""],["Partner Name","","",o.metadata.partner.businessName,"","",o.metadata.reference.businessName,"",""],["Commerce Number","","",o.metadata.partner.commerceNumber,"","",o.metadata.reference.commerceNumber,"",""],["Start Date","","",o.metadata.partner.startDate||"N/A","","",o.metadata.reference.startDate||"N/A","",""],["Publish Date","","",o.metadata.partner.publishDate||"N/A","","",o.metadata.reference.publishDate||"N/A","",""],["","","","","","","","",""],["Working Hours","","","","","","","",""],["Full Time Hours","","","".concat(o.workingHours.partner.fullTimeHours," ").concat(o.workingHours.partner.fullTimeHoursPer),"","","".concat(o.workingHours.reference.fullTimeHours," ").concat(o.workingHours.reference.fullTimeHoursPer),"",""],["Comments","","",o.workingHours.partner.comments,"","",o.workingHours.reference.comments,"",""],["","","","","","","","",""],["Remuneration Components:","","","","","","","",""]],console.log(s),r.getRange("A1:I12").values=s,r.getRange("A1:I1").format.font.bold=!0,e.n=8,n.sync();case 8:console.log("Metadata comparison added to EP sheet."),u=13,c=[{key:"holidayAllowances",title:"Holiday Allowances"},{key:"leave",title:"Leave"},{key:"individualChoiceBudget",title:"Individual Choice Budget"},{key:"paymentsData",title:"Payments"},{key:"wageIncrements",title:"Wage Increments"},{key:"travelExpensesData",title:"Travel Expenses"},{key:"allowances",title:"Allowances"}],l=[{key:"pensionData",title:"Pension"}],m=[{key:"sickPay",title:"Sick Pay"},{key:"reimbursementsData",title:"Reimbursements"}],(f=r.getRangeByIndexes(u,0,1,9)).values=[["Essential Remuneration Components","","","","","","","",""]],f.format.font.bold=!0,f.format.fill.color="#ebaf56ff",p=0,v=c;case 9:if(!(p<v.length)){e.n=12;break}if(y=v[p],!(g=o[y.key])||!g.partner.hasData&&!g.reference.hasData){e.n=11;break}return e.n=10,W(r,y.title,g.partner,g.reference,u);case 10:u=e.v;case 11:p++,e.n=9;break;case 12:(b=r.getRangeByIndexes(u,0,1,9)).values=[["Non-Essential Remuneration Components","","","","","","","",""]],b.format.font.bold=!0,b.format.fill.color="#ebaf56ff",A=0,N=l;case 13:if(!(A<N.length)){e.n=16;break}if(P=N[A],!(w=o[P.key])||!w.partner.hasData&&!w.reference.hasData){e.n=15;break}return e.n=14,W(r,P.title,w.partner,w.reference,u);case 14:u=e.v;case 15:A++,e.n=13;break;case 16:(D=r.getRangeByIndexes(u,0,1,9)).values=[["Conditional Remuneration Components","","","","","","","",""]],D.format.font.bold=!0,D.format.fill.color="#ebaf56ff",O=0,E=m;case 17:if(!(O<E.length)){e.n=20;break}if(T=E[O],!(k=o[T.key])||!k.partner.hasData&&!k.reference.hasData){e.n=19;break}return e.n=18,W(r,T.title,k.partner,k.reference,u);case 18:u=e.v;case 19:O++,e.n=17;break;case 20:return r.getRange("A:A").format.columnWidth=120,r.getRange("B:C").format.columnWidth=60,r.getRange("D:D").format.columnWidth=120,r.getRange("E:E").format.columnWidth=120,r.getRange("F:G").format.columnWidth=60,e.n=21,n.sync();case 21:console.log("EP sheet generated successfully for ".concat(a));case 22:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function x(e,n,t){return B.apply(this,arguments)}function B(){return(B=A(h().m(function e(n,t,a){var r,o,i,s,u,c,l,m,f,p,v,y,g,b,A;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Preparing to load data into ILB sheet for partner ID: ".concat(t)),e.p=1,r=n.workbook.worksheets.getItem("ILB"),e.n=2,n.sync();case 2:console.log("ILB worksheet found, clearing"),r.getUsedRange().clear(),e.n=4;break;case 3:return e.p=3,e.v,console.log("ILB worksheet not found, creating a new one."),r=n.workbook.worksheets.add("ILB"),n.workbook.worksheets.getItem("Sheet1").delete(),e.n=4,n.sync();case 4:return r.activate(),e.n=5,n.sync();case 5:return e.n=6,S(n);case 6:return console.log("Loading data for partner: ".concat(a," into ILB sheet")),o=d.generateMetadata(t),console.log("Metadata generated:",o),(i=r.getRange("A1:C10")).values=o,i.format.font.bold=!0,i.getColumn(0).format.fill.color="#E3F2FD",H(i,!1),e.n=7,n.sync();case 7:if(s=11,u=d.getPensionableComponents(t),console.log("Pensionable Components:",u),c=d.generateHolidayAllowances(t),console.log("Holiday Allowances Data:",c),!(c.length>0)){e.n=9;break}return e.n=8,j(r,"Holiday Allowances",c,s);case 8:s=e.v;case 9:if(!((l=d.generateLeaveData(t)).length>0)){e.n=11;break}return e.n=10,j(r,"Leave",l,s);case 10:s=e.v;case 11:if(!((m=d.generateIndividualChoiceBudget(t)).length>0)){e.n=13;break}return e.n=12,j(r,"Individual Choice Budget",m,s);case 12:s=e.v;case 13:if(!((f=d.generatePensionData(t)).length>0)){e.n=15;break}return e.n=14,j(r,"Pension",f,s);case 14:s=e.v;case 15:if(!((p=d.generateSickPayData(t)).length>0)){e.n=17;break}return e.n=16,j(r,"Sick Pay",p,s);case 16:s=e.v;case 17:if(!((v=d.generateAllowances(t)).length>0)){e.n=19;break}return e.n=18,j(r,"Allowances",v,s);case 18:s=e.v;case 19:if(!((y=d.generateReimbursementsData(t)).length>0)){e.n=21;break}return e.n=20,j(r,"Reimbursements",y,s);case 20:s=e.v;case 21:if(!((g=d.generateTravelExpensesData(t)).length>0)){e.n=23;break}return e.n=22,j(r,"Travel Expenses",g,s);case 22:s=e.v;case 23:if(!((b=d.generatePaymentsData(t)).length>0)){e.n=25;break}return e.n=24,j(r,"Payments",b,s);case 24:s=e.v;case 25:if(!((A=d.generateWageIncrementsData(t)).length>0)){e.n=27;break}return e.n=26,j(r,"Wage Increments",A,s);case 26:s=e.v;case 27:return r.getRange("A:I").format.columnWidth=100,r.getRange("A:I").format.wrapText=!1,e.n=28,n.sync();case 28:console.log("Data loaded successfully into ILB sheet for ".concat(a));case 29:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function S(e){return F.apply(this,arguments)}function F(){return(F=A(h().m(function e(n){var t,a,r,o,i;return h().w(function(e){for(;;)switch(e.n){case 0:return console.log("Clearing existing named ranges..."),(t=n.workbook.names).load("items"),e.n=1,n.sync();case 1:a=t.items.slice(),r=p(a);try{for(r.s();!(o=r.n()).done;)i=o.value,console.log("Deleting named range: ".concat(i.name)),i.delete()}catch(e){r.e(e)}finally{r.f()}if(!(a.length>0)){e.n=3;break}return e.n=2,n.sync();case 2:console.log("Cleared ".concat(a.length," existing named ranges")),e.n=4;break;case 3:console.log("No existing named ranges to clear");case 4:return e.a(2)}},e)}))).apply(this,arguments)}function H(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.format.borders.getItem("EdgeTop").style="Continuous",e.format.borders.getItem("EdgeBottom").style="Continuous",e.format.borders.getItem("EdgeLeft").style="Continuous",e.format.borders.getItem("EdgeRight").style="Continuous",n&&(e.format.borders.getItem("InsideVertical").style="Continuous",e.format.borders.getItem("InsideHorizontal").style="Continuous")}function j(e,n,t,a){return L.apply(this,arguments)}function L(){return(L=A(h().m(function e(n,t,a,r){var o,i,s,u;return h().w(function(e){for(;;)switch(e.n){case 0:if(a&&0!==a.length){e.n=1;break}return e.a(2,r);case 1:return o=r,(i=n.getRangeByIndexes(o,0,1,1)).values=[[t]],i.format.font.bold=!0,i.format.fill.color="#ADD8E6",H(i,!1),o++,s=Math.max(0,Math.max.apply(Math,f(a.map(function(e){return e.length})))-1),(u=n.getRangeByIndexes(o,0,a.length,s+1)).values=a,H(u),a.length>0&&(n.getRangeByIndexes(o,0,1,s+1).format.font.bold=!0),e.a(2,o+a.length+1)}},e)}))).apply(this,arguments)}function W(e,n,t,a,r){return M.apply(this,arguments)}function M(){return(M=A(h().m(function e(n,t,a,r,o){var i,s,u,c,l,m,d,f,p,v,y,g;return h().w(function(e){for(;;)if(0===e.n){for(i=o,console.log("Adding EP component: ".concat(t," at row ").concat(i)),console.log("Partner Data:",a),console.log("Reference Data:",r),(s=n.getRangeByIndexes(i,0,1,9)).values=[[t,"","","","","","","",""]],s.format.font.bold=!0,s.format.fill.color="#ADD8E6",H(s,!1),i++,(u=n.getRangeByIndexes(i,0,1,9)).values=[["Partner Data","","","","Reference Data","","","",""]],u.format.font.bold=!0,u.format.fill.color="#E3F2FD",i++,c=a.hasData?a.rows:[["No data available","","","","","","","",""]],l=r.hasData?r.rows:[["No data available","","","","","","","",""]],m=Math.max(c.length,l.length),d=[],console.log("Combining data for EP component: ".concat(t,", max rows: ").concat(m),d),f=0;f<m;f++)p=f<c.length?c[f]:["","","","","","","","",""],v=f<l.length?l[f]:["","","","","","","","",""],y=[p[0]||"",p[1]||"",p[2]||"","",v[0]||"",v[1]||"",v[2]||"","",""],d.push(y);return console.log("Combined data for EP component: ".concat(t),d),d.length>0&&(g=n.getRangeByIndexes(i,0,d.length,d[0].length),console.log("Adding data range for EP component: ".concat(t," at row ").concat(i),g),g.values=d,i+=d.length),i++,console.log("Finished adding EP component: ".concat(t,", next available row is ").concat(i)),e.a(2,i)}},e)}))).apply(this,arguments)}function U(e,n){var t=document.getElementById("status");t&&(t.textContent=e,t.className="status ".concat(n))}Office.onReady(function(){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("load-partners").onclick=w,document.getElementById("partner-select").onchange=O,document.getElementById("load-remuneration").onclick=E,document.getElementById("generate-ep-sheet").onclick=k,w()})}(),new URL(t(58394),t.b)}();
//# sourceMappingURL=taskpane.js.map