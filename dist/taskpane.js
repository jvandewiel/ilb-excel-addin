/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,n,t){e.exports=t.p+"7e68e84774d219c9c3b1.css"}},n={};function t(a){var r=n[a];if(void 0!==r)return r.exports;var o=n[a]={exports:{}};return e[a](o,o.exports,t),o.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var a=n.getElementsByTagName("script");if(a.length)for(var r=a.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=a[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach(function(n){c(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function o(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function u(t,a,r,o){var u=a&&a.prototype instanceof c?a:c,l=Object.create(u.prototype);return i(l,"_invoke",function(t,a,r){var o,i,u,c=0,l=r||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,i=0,u=e,d.n=t,s}};function f(t,a){for(i=t,u=a,n=0;!m&&c&&!r&&n<l.length;n++){var r,o=l[n],f=d.p,p=o[2];t>3?(r=p===a)&&(u=o[(i=o[4])?5:(i=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=t<2&&f<o[1])?(i=0,d.v=a,d.n=o[1]):f<p&&(r=t<3||o[0]>a||a>p)&&(o[4]=t,o[5]=a,d.n=p,i=0))}if(r||t>1)return s;throw m=!0,a}return function(r,l,p){if(c>1)throw TypeError("Generator is already running");for(m&&1===l&&f(l,p),i=l,u=p;(n=i<2?e:u)||!m;){o||(i?i<3?(i>1&&(d.n=-1),f(i,u)):d.n=u:d.v=u);try{if(c=2,o){if(i||(r="next"),n=o[r]){if(!(n=n.call(o,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,i<2&&(i=0)}else 1===i&&(n=o.return)&&n.call(o),i<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),i=1);o=e}else if((n=(m=d.n<0)?u:t.call(a,d))!==s)break}catch(n){o=e,i=1,u=n}finally{c=1}}return{value:n,done:m}}}(t,r,o),!0),l}var s={};function c(){}function l(){}function m(){}n=Object.getPrototypeOf;var d=[][a]?n(n([][a]())):(i(n={},a,function(){return this}),n),f=m.prototype=c.prototype=Object.create(d);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,i(e,r,"GeneratorFunction")),e.prototype=Object.create(f),e}return l.prototype=m,i(f,"constructor",m),i(m,"constructor",l),l.displayName="GeneratorFunction",i(m,r,"GeneratorFunction"),i(f),i(f,r,"Generator"),i(f,a,function(){return this}),i(f,"toString",function(){return"[object Generator]"}),(o=function(){return{w:u,m:p}})()}function i(e,n,t,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}i=function(e,n,t,a){function o(n,t){i(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},i(e,n,t,a)}function u(e,n,t,a,r,o,i){try{var u=e[o](i),s=u.value}catch(e){return void t(e)}u.done?n(s):Promise.resolve(s).then(a,r)}function s(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,l(a.key),a)}}function c(e,n,t){return(n=l(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var a=t.call(n,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var m=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,"remunerationData",[]),c(this,"isLoaded",!1)},t=[{key:"loadData",value:(a=o().m(function e(){var n,t;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isLoaded){e.n=1;break}return e.a(2);case 1:return e.p=1,console.log("Loading remuneration data from JSON file..."),e.n=2,fetch("https://yergroup-my.sharepoint.com/:u:/g/personal/joostvandewiel_yer_nl/EeZb6Ly0epZDqrSWnGSMMWkBrvYvaeYh7LarGU78Ul-81Q?e=7RqbNz");case 2:if((n=e.v).ok){e.n=3;break}throw new Error("Failed to load data: ".concat(n.status," ").concat(n.statusText));case 3:return e.n=4,n.json();case 4:this.remunerationData=e.v,this.isLoaded=!0,console.log("Loaded ".concat(this.remunerationData.length," remuneration records")),e.n=6;break;case 5:throw e.p=5,t=e.v,console.error("Error loading remuneration data:",t),new Error("Failed to load remuneration data: ".concat(t.message));case 6:return e.a(2)}},e,this,[[1,5]])}),i=function(){var e=this,n=arguments;return new Promise(function(t,r){var o=a.apply(e,n);function i(e){u(o,t,r,i,s,"next",e)}function s(e){u(o,t,r,i,s,"throw",e)}i(void 0)})},function(){return i.apply(this,arguments)})},{key:"getPartners",value:function(){if(!this.isLoaded)return console.warn("Data not loaded yet. Call loadData() first."),[];var e=new Map;this.remunerationData.forEach(function(n){n.company&&n.company.id&&n.company.businessName&&e.set(n.company.id,{id:n.company.id,businessName:n.company.businessName})});var n=Array.from(e.values());return console.log("Found ".concat(n.length," unique partners")),n.sort(function(e,n){return e.businessName.localeCompare(n.businessName)})}},{key:"getPartnerRemuneration",value:function(e){if(!this.isLoaded)return console.warn("Data not loaded yet. Call loadData() first."),[];var n=this.remunerationData.filter(function(n){return n.company&&n.company.id===e});return console.log("Found ".concat(n.length," remuneration records for partner: ").concat(e)),n}},{key:"formatAmountDisplay",value:function(e,n){return e?"".concat(e).concat("Percentage"===(null==n?void 0:n.value)?"%":""):"N/A"}},{key:"mapCodeToComponent",value:function(e){switch(e){case"CAOAllowances":return"allowances";case"CAOHolidayAllowance":return"holidayAllowance";case"CAOOneTimePayment":return"oneTimePayment";case"CAOFixedPayment":return"fixedPayment";case"CAOVariablePayment":return"variablePayment";case"CAOHoliday":return"holiday";case"CAOWageTable":return"wageTable";case"CAOWageIncrement":return"wageIncrement";case"CAOPeriodicIncrement":return"periodicIncrement";case"CAORetroactiveIncrement":return"retroactiveIncrement";case"CAOTravelExpenses":return"travelExpenses";case"CAOTravelTime":return"travelTime";case"Other":return"other";default:return"unknown"}}},{key:"enhancePensionableEarningsWithComponents",value:function(e){var n=this;return e.map(function(e){return r(r({},e),{},{component:n.mapCodeToComponent(e.code)})})}},{key:"generateDataWithStandardStructure",value:function(e,t,a,r){var o=this.getPartnerRemuneration(e),i=Array(a.length).fill("").map(function(e,n){return 0===n?t:""});if(!o||0===o.length)return[i];var u=[];u.push(a);var s=r(o);return u.push.apply(u,n(s)),1===u.length&&u.push(i),u}},{key:"generateMetadata",value:function(e){var n=this.getPartnerRemuneration(e);if(!n||0===n.length)return[["Metadata","",""],["Partner Name","No data available",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]];var t=n[0],a=t.company,r=t.workingHours;return[["ILB Remuneration Data","",""],["Partner Name",(null==a?void 0:a.businessName)||"Unknown",""],["Commerce Number",(null==a?void 0:a.commerceNumber)||"N/A",""],["Version","".concat(t.lenderVersion,"/").concat(t.totalVersions),""],["Start Date",t.startDate||"N/A",""],["Publish Date",t.publishDate||"N/A",""],["Full Time Hours",(null==r?void 0:r.fullTimeHours)||"N/A",(null==r?void 0:r.fullTimeHoursPer)||""],["Working Hours Comments",(null==r?void 0:r.workingHoursComments)||"N/A",""],["","",""],["Remuneration Components:","",""]]}},{key:"generateHolidayAllowances",value:function(e){var n=this,t=this.getPartnerRemuneration(e),a=["No holiday allowances data available","","","","","","","",""];if(!t||0===t.length)return[a];var r=[],o=this.getPensionableComponents(e).some(function(e){return"CAOHolidayAllowance"===e.code});return r.push(["Allowance Name","Amount","Amount Type","Interval","Based On","Individual Choice Budget","Pensionable","Conditions","Description"]),t.forEach(function(e){e.holidayAllowances&&e.holidayAllowances.length>0&&e.holidayAllowances.forEach(function(e){var t,a=n.formatAmountDisplay(e.amount,e.amountType);r.push(["Holiday Allowance",a,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A",e.basedOn||"N/A",e.isPartOfIndividualChoiceBudget?"true":"",o?"true":"","N/A",e.description||"N/A"])})}),1===r.length&&r.push(a),r}},{key:"generateAllowances",value:function(e){var n=this,t=this.getPartnerRemuneration(e),a=["No allowances data available","","","","","","","",""];if(!t||0===t.length)return[a];var r=[],o=this.getPensionableComponents(e).some(function(e){return"CAOAllowances"===e.code});return r.push(["Allowance Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"]),t.forEach(function(e){e.allowances&&e.allowances.hasAllowances&&e.allowances.allowances&&e.allowances.allowances.forEach(function(e){var t=e.name||e.typeTitle||"Unnamed Allowance";e.allowanceComponents&&e.allowanceComponents.length>0?e.allowanceComponents.forEach(function(e){var a,i=n.formatAmountDisplay(e.amount,e.amountType);r.push([t,i,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","",o?"true":"",e.conditions||"N/A",e.description||"N/A"])}):r.push([t,"N/A","N/A","N/A","N/A","",o?"true":"",e.conditions||"N/A","No components available"])})}),1===r.length&&r.push(a),console.log(r),r}},{key:"generateTravelExpensesData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No travel expenses data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(t){var a=[],r=n.getPensionableComponents(e).some(function(e){return"CAOTravelExpenses"===e.code||"CAOTravelTime"===e.code});return t.forEach(function(e){e.travelExpensesData&&e.travelExpensesData.hasTravelExpenses&&e.travelExpensesData.travelExpenses&&e.travelExpensesData.travelExpenses.forEach(function(e){var t,o=(null===(t=e.compensationType)||void 0===t?void 0:t.value)||"Unknown";e.components&&e.components.length>0?e.components.forEach(function(e){var t,i,u=n.formatAmountDisplay(e.amount,e.amountType),s="Travel Expense";if("Hours"===(null===(t=e.amountType)||void 0===t?void 0:t.value))s="Travel Time";else if("Money"===o)s="Travel Allowance";else if("Both"===o){var c;s="Hours"===(null===(c=e.amountType)||void 0===c?void 0:c.value)?"Travel Time":"Travel Allowance"}a.push([s,u,(null===(i=e.amountType)||void 0===i?void 0:i.value)||"N/A",o||"N/A",e.interval||"N/A","",r?"true":"",e.conditions||"N/A",e.description||"N/A"])}):a.push(["Travel Expense","N/A","N/A",o||"N/A","N/A","",r?"true":"","N/A","Travel expense with ".concat(o," compensation")])})}),a})}},{key:"generateWageIncrementsData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No wage increments data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.wageIncrements&&e.wageIncrements.hasWageIncrements&&(e.wageIncrements.incrementData&&e.wageIncrements.incrementData.length>0&&e.wageIncrements.incrementData.forEach(function(e){var a=n.formatAmountDisplay(e.percentage,{value:"%"===e.incrementType?"Percentage":"Amount",otherValue:null});t.push(["Regular Wage Increment",a,"%"===e.incrementType?"Percentage":"Amount","Salary","Effective ".concat(e.date),"","",e.appliesToAllFunctions?"Applies to all functions":"Function-specific",e.explanation||"Wage increment of ".concat(e.percentage).concat(e.incrementType," effective ").concat(e.date)])}),e.wageIncrements.retroactiveIncrementData&&e.wageIncrements.retroactiveIncrementData.length>0&&e.wageIncrements.retroactiveIncrementData.forEach(function(e){var a=n.formatAmountDisplay(e.percentage,{value:"%"===e.incrementType?"Percentage":"Amount",otherValue:null});t.push(["Retroactive Wage Increment",a,"%"===e.incrementType?"Percentage":"Amount","Salary","Effective ".concat(e.date),"","",e.appliesToAllFunctions?"Applies to all functions":"Function-specific",e.explanation||"Retroactive wage increment of ".concat(e.percentage).concat(e.incrementType," effective ").concat(e.date)])}),e.wageIncrements.periodicalData&&e.wageIncrements.periodicalData.length>0&&e.wageIncrements.periodicalData.forEach(function(e){t.push(["Periodical Increment","N/A","Schedule-based","Performance & Experience","".concat(e.experiencePeriodAmount," ").concat(e.experiencePeriodAmountType),"","","".concat(e.eligibleType," - ").concat(e.performanceMoment),e.periodicals||"Performance-based salary progression"])}))}),t})}},{key:"getPensionableComponents",value:function(e){var t=this.getPartnerRemuneration(e),a=t.length>0?t[0].pensionData:null;if(!a||!a.items||0===a.items.length)return[];var r=[];return a.items.forEach(function(e){e.pensionableEarnings&&e.pensionableEarnings.length>0&&r.push.apply(r,n(e.pensionableEarnings))}),this.enhancePensionableEarningsWithComponents(r)}},{key:"generatePensionData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No pension data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.pensionData&&e.pensionData.hasPension&&e.pensionData.items&&e.pensionData.items.forEach(function(e){var a,r=n.formatAmountDisplay(e.amount,e.amountType),o=e.pensionableEarnings&&e.pensionableEarnings.length>0?e.pensionableEarnings.map(function(e){return e.title}).join(", "):"N/A";t.push(["Pension",r,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",o||"N/A",e.interval||"N/A","","","N/A",e.description||"N/A"])})}),t})}},{key:"generateLeaveData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No leave data available",["Leave Type","Amount","Amount Type","Interval","Based On","Individual Choice Budget","Pensionable","Conditions","Description"],function(t){var a=[],r=n.getPensionableComponents(e).some(function(e){return"CAOHoliday"===e.code}),o=function(e,t){e.forEach(function(e){var o,i=n.formatAmountDisplay(e.amount,e.amountType);a.push([t,i,(null===(o=e.amountType)||void 0===o?void 0:o.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"",r?"true":"",e.conditions||"N/A",e.description||"N/A"])})};return t.forEach(function(e){if(e.leave){var n=e.leave;n.hasWorkingHoursReduction&&n.workingHoursReductions&&o(n.workingHoursReductions,"Working Hours Reduction"),n.hasVacationDays&&n.vacationDays&&o(n.vacationDays,"Vacation Days"),n.hasSpecialLeave&&n.specialLeave&&o(n.specialLeave,"Special Leave"),n.hasAdditionalWAZO&&n.additionalWAZO&&o(n.additionalWAZO,"Additional WAZO"),n.hasMandatoryLeave&&n.mandatoryLeave&&o(n.mandatoryLeave,"Mandatory Leave")}}),a})}},{key:"generateSickPayData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No sick pay data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.sickPay&&e.sickPay.sickPayAmounts&&Array.isArray(e.sickPay.sickPayAmounts)&&e.sickPay.sickPayAmounts.length>0&&e.sickPay.sickPayAmounts.forEach(function(e){var a,r,o=n.formatAmountDisplay(e.amount,e.amountType);t.push(["Sick Pay (".concat((null===(a=e.sickPayYear)||void 0===a?void 0:a.value)||"Unknown Year",")"),o,(null===(r=e.amountType)||void 0===r?void 0:r.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","","N/A","N/A"])})}),t})}},{key:"generateIndividualChoiceBudget",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No individual choice budget data available",["Component Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){if(e.individualChoiceBudget&&e.individualChoiceBudget.hasIndividualChoiceBudget){var a,r=e.individualChoiceBudget,o=n.formatAmountDisplay(r.amount,r.amountType);t.push(["Individual Choice Budget",o,(null===(a=r.amountType)||void 0===a?void 0:a.value)||"N/A",r.basedOn||"N/A",r.interval||"N/A","true","","N/A","Main budget allocation"]),r.items&&r.items.length>0&&r.items.forEach(function(e){var a,r=n.formatAmountDisplay(e.amount,e.amountType),o="Other"===e.name&&e.typeOther?e.typeOther:e.name||"Unnamed Component";t.push([o,r,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"","","N/A",e.description||"N/A"])})}}),t})}},{key:"generateReimbursementsData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No reimbursements data available",["Reimbursement Name","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(e){var t=[];return e.forEach(function(e){e.reimbursementsData&&e.reimbursementsData.hasReimbursements&&e.reimbursementsData.reimbursements&&e.reimbursementsData.reimbursements.forEach(function(e){var a,r=n.formatAmountDisplay(e.amount,e.amountType);t.push([e.name||"Unnamed Reimbursement",r,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","","",e.conditions||"N/A",e.description||"N/A"])})}),t})}},{key:"generatePaymentsData",value:function(e){var n=this;return this.generateDataWithStandardStructure(e,"No payments data available",["Payment Type","Amount","Amount Type","Based On","Interval","Individual Choice Budget","Pensionable","Conditions","Description"],function(t){var a=[],r=n.getPensionableComponents(e),o=r.some(function(e){return"CAOFixedPayment"===e.code}),i=r.some(function(e){return"CAOOneTimePayment"===e.code}),u=r.some(function(e){return"CAOVariablePayment"===e.code});return t.forEach(function(e){e.paymentsData&&(e.paymentsData.hasFixedPayments&&e.paymentsData.fixedPayments&&e.paymentsData.fixedPayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType),i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A";a.push(["Fixed Payment",r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",i,e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"",o?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.paymentsData.hasOneTimePayments&&e.paymentsData.oneTimePayments&&e.paymentsData.oneTimePayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType),o="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A";a.push(["One-Time Payment",r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",o,e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"",i?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.paymentsData.hasVariablePayments&&e.paymentsData.variablePayments&&e.paymentsData.variablePayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType);if(e.hasMinMaxAmount&&(null!==e.minAmount||null!==e.maxAmount)){var o=[null!==e.minAmount?"Min: ".concat(e.minAmount):"",null!==e.maxAmount?"Max: ".concat(e.maxAmount):""].filter(Boolean).join(", ");o&&(r+=" (".concat(o,")"))}var i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",s=e.name?"Variable Payment (".concat(e.name,")"):"Variable Payment";a.push([s,r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",i,e.interval||"N/A","",u?"true":"",e.date?"Payment date: ".concat(e.date):"N/A",e.description||"N/A"])}),e.paymentsData.hasAnniversaryPayments&&e.paymentsData.anniversaryPayments&&e.paymentsData.anniversaryPayments.forEach(function(e){var t,r=n.formatAmountDisplay(e.amount,e.amountType),o="Anniversary Payment (".concat(e.amountOfYears," years)"),i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",u="Other"===e.dateOrCondition&&e.dateOrConditionOther?e.dateOrConditionOther:e.dateOrCondition||"N/A";a.push([o,r,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",i,e.interval||"N/A","","",u,e.description||"N/A"])}))}),a})}},{key:"extractAllPensionableEarnings",value:function(e){if(!e||!e.items||0===e.items.length)return[];var t=[];return e.items.forEach(function(e){e.pensionableEarnings&&e.pensionableEarnings.length>0&&t.push.apply(t,n(e.pensionableEarnings))}),this.enhancePensionableEarningsWithComponents(t)}},{key:"getPensionableComponentTypes",value:function(e){return this.getPensionableComponents(e).map(function(e){return e.component}).filter(function(e,n,t){return e&&t.indexOf(e)===n})}},{key:"isComponentTypePensionable",value:function(e,n){return this.getPensionableComponentTypes(e).includes(n)}}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a,i}(),d=new m;function f(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=v(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw o}}}}function v(e,n){if(e){if("string"==typeof e)return y(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,n):void 0}}function y(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function h(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",r=t.toStringTag||"@@toStringTag";function o(t,a,r,o){var s=a&&a.prototype instanceof u?a:u,c=Object.create(s.prototype);return g(c,"_invoke",function(t,a,r){var o,u,s,c=0,l=r||[],m=!1,d={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(n,t){return o=n,u=0,s=e,d.n=t,i}};function f(t,a){for(u=t,s=a,n=0;!m&&c&&!r&&n<l.length;n++){var r,o=l[n],f=d.p,p=o[2];t>3?(r=p===a)&&(s=o[(u=o[4])?5:(u=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=t<2&&f<o[1])?(u=0,d.v=a,d.n=o[1]):f<p&&(r=t<3||o[0]>a||a>p)&&(o[4]=t,o[5]=a,d.n=p,u=0))}if(r||t>1)return i;throw m=!0,a}return function(r,l,p){if(c>1)throw TypeError("Generator is already running");for(m&&1===l&&f(l,p),u=l,s=p;(n=u<2?e:s)||!m;){o||(u?u<3?(u>1&&(d.n=-1),f(u,s)):d.n=s:d.v=s);try{if(c=2,o){if(u||(r="next"),n=o[r]){if(!(n=n.call(o,s)))throw TypeError("iterator result is not an object");if(!n.done)return n;s=n.value,u<2&&(u=0)}else 1===u&&(n=o.return)&&n.call(o),u<2&&(s=TypeError("The iterator does not provide a '"+r+"' method"),u=1);o=e}else if((n=(m=d.n<0)?s:t.call(a,d))!==i)break}catch(n){o=e,u=1,s=n}finally{c=1}}return{value:n,done:m}}}(t,r,o),!0),c}var i={};function u(){}function s(){}function c(){}n=Object.getPrototypeOf;var l=[][a]?n(n([][a]())):(g(n={},a,function(){return this}),n),m=c.prototype=u.prototype=Object.create(l);function d(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,g(e,r,"GeneratorFunction")),e.prototype=Object.create(m),e}return s.prototype=c,g(m,"constructor",c),g(c,"constructor",s),s.displayName="GeneratorFunction",g(c,r,"GeneratorFunction"),g(m),g(m,r,"Generator"),g(m,a,function(){return this}),g(m,"toString",function(){return"[object Generator]"}),(h=function(){return{w:o,m:d}})()}function g(e,n,t,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}g=function(e,n,t,a){function o(n,t){g(e,n,function(e){return this._invoke(n,t,e)})}n?r?r(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(o("next",0),o("throw",1),o("return",2))},g(e,n,t,a)}function b(e,n,t,a,r,o,i){try{var u=e[o](i),s=u.value}catch(e){return void t(e)}u.done?n(s):Promise.resolve(s).then(a,r)}function A(e){return function(){var n=this,t=arguments;return new Promise(function(a,r){var o=e.apply(n,t);function i(e){b(o,a,r,i,u,"next",e)}function u(e){b(o,a,r,i,u,"throw",e)}i(void 0)})}}var w=[],P="";function O(){return N.apply(this,arguments)}function N(){return(N=A(h().m(function e(){var n,t;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Starting to load partners..."),R("Loading partners from JSON data...","loading"),e.p=1,e.n=2,d.loadData();case 2:w=d.getPartners(),console.log("Partners loaded:",w),(n=document.getElementById("partner-select"))&&(n.innerHTML='<option value="">Select a partner...</option>',w.forEach(function(e){console.log("Adding partner to dropdown:",e);var t=document.createElement("option");t.value=e.id,t.textContent=e.businessName,n.appendChild(t)}),n.disabled=!1),R("Loaded ".concat(w.length," partners"),"success"),e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error loading partners:",t),R("Error loading partners: ".concat(t.message),"error");case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function T(){var e=document.getElementById("partner-select");if(e){P=e.value;var n=document.getElementById("load-remuneration");if(n&&(P?n.classList.remove("disabled"):n.classList.add("disabled")),P){var t=w.find(function(e){return e.id===P});R("Selected partner: ".concat((null==t?void 0:t.businessName)||P),"success")}else R("Select a partner to continue","loading")}}function D(){return C.apply(this,arguments)}function C(){return C=A(h().m(function e(){var n,t,a,r;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!(n=document.getElementById("load-remuneration"))||!n.classList.contains("disabled")){e.n=1;break}return e.a(2);case 1:if(P){e.n=2;break}return R("Please select a partner first","error"),e.a(2);case 2:if(t=w.find(function(e){return e.id===P}),R("Loading remuneration and allowances for ".concat(null==t?void 0:t.businessName,"..."),"loading"),e.p=3,(a=d.getPartnerRemuneration(P))&&0!==a.length){e.n=4;break}return R("No remuneration available for this partner","error"),e.a(2);case 4:return e.n=5,Excel.run(function(){var e=A(h().m(function e(n){return h().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,E(n,P,(null==t?void 0:t.businessName)||"Unknown");case 1:R("Remuneration and allowances loaded successfully for ".concat(null==t?void 0:t.businessName," (").concat(a.length," records)"),"success");case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 5:e.n=7;break;case 6:e.p=6,r=e.v,console.error("Error loading remuneration:",r),R("Error loading remuneration: ".concat(r.message),"error");case 7:return e.a(2)}},e,null,[[3,6]])})),C.apply(this,arguments)}function E(e,n,t){return I.apply(this,arguments)}function I(){return(I=A(h().m(function e(n,t,a){var r,o,i,u,s,c,l,m,f,p,v,y,g,b,A,w,P,O,N;return h().w(function(e){for(;;)switch(e.n){case 0:return console.log("Preparing to load data into ILB sheet for partner ID: ".concat(t)),(o=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:if(!(i=o.items.find(function(e){return"ILB"===e.name}))){e.n=2;break}r=i,e.n=3;break;case 2:return console.log("ILB worksheet not found, creating a new one."),r=o.add("ILB"),e.n=3,n.sync();case 3:return console.log("Clearing existing data in ILB sheet..."),e.n=4,k(n);case 4:return(u=r.getUsedRange()).load("address"),e.n=5,n.sync();case 5:if("A1:A1"===u.address&&""===u.values[0][0]){e.n=6;break}return u.clear(),e.n=6,n.sync();case 6:return console.log("Loading data for partner: ".concat(a," into ILB sheet")),s=d.generateMetadata(t),console.log("Metadata generated:",s),(c=r.getRange("A1:C10")).values=s,c.format.font.bold=!0,c.getColumn(0).format.fill.color="#E3F2FD",x(c,!1),l=r.getRange("B7"),n.workbook.names.add("WorkingHoursPerWeek",l),e.n=7,n.sync();case 7:if(m=11,f=d.getPensionableComponents(t),console.log("Pensionable Components:",f),p=d.generateHolidayAllowances(t),console.log("Holiday Allowances Data:",p),!(p.length>0)){e.n=9;break}return e.n=8,B(r,"Holiday Allowances",p,m);case 8:m=e.v;case 9:if(!((v=d.generateLeaveData(t)).length>0)){e.n=11;break}return e.n=10,B(r,"Leave",v,m);case 10:m=e.v;case 11:if(!((y=d.generateIndividualChoiceBudget(t)).length>0)){e.n=13;break}return e.n=12,B(r,"Individual Choice Budget",y,m);case 12:m=e.v;case 13:if(!((g=d.generatePensionData(t)).length>0)){e.n=15;break}return e.n=14,B(r,"Pension",g,m);case 14:m=e.v;case 15:if(!((b=d.generateSickPayData(t)).length>0)){e.n=17;break}return e.n=16,B(r,"Sick Pay",b,m);case 16:m=e.v;case 17:if(!((A=d.generateAllowances(t)).length>0)){e.n=19;break}return e.n=18,B(r,"Allowances",A,m);case 18:m=e.v;case 19:if(!((w=d.generateReimbursementsData(t)).length>0)){e.n=21;break}return e.n=20,B(r,"Reimbursements",w,m);case 20:m=e.v;case 21:if(!((P=d.generateTravelExpensesData(t)).length>0)){e.n=23;break}return e.n=22,B(r,"Travel Expenses",P,m);case 22:m=e.v;case 23:if(!((O=d.generatePaymentsData(t)).length>0)){e.n=25;break}return e.n=24,B(r,"Payments",O,m);case 24:m=e.v;case 25:if(!((N=d.generateWageIncrementsData(t)).length>0)){e.n=27;break}return e.n=26,B(r,"Wage Increments",N,m);case 26:m=e.v;case 27:return r.getUsedRange().format.autofitColumns(),r.getRange("B:B").format.columnWidth=100,r.getCell(7,1).format.wrapText=!1,r.getRange("C:G").format.columnWidth=100,e.n=28,n.sync();case 28:console.log("Data loaded successfully into ILB sheet for ".concat(a));case 29:return e.a(2)}},e)}))).apply(this,arguments)}function k(e){return S.apply(this,arguments)}function S(){return(S=A(h().m(function e(n){var t,a,r,o,i;return h().w(function(e){for(;;)switch(e.n){case 0:return console.log("Clearing existing named ranges..."),(t=n.workbook.names).load("items"),e.n=1,n.sync();case 1:a=t.items.slice(),r=p(a);try{for(r.s();!(o=r.n()).done;)i=o.value,console.log("Deleting named range: ".concat(i.name)),i.delete()}catch(e){r.e(e)}finally{r.f()}if(!(a.length>0)){e.n=3;break}return e.n=2,n.sync();case 2:console.log("Cleared ".concat(a.length," existing named ranges")),e.n=4;break;case 3:console.log("No existing named ranges to clear");case 4:return e.a(2)}},e)}))).apply(this,arguments)}function x(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.format.borders.getItem("EdgeTop").style="Continuous",e.format.borders.getItem("EdgeBottom").style="Continuous",e.format.borders.getItem("EdgeLeft").style="Continuous",e.format.borders.getItem("EdgeRight").style="Continuous",n&&(e.format.borders.getItem("InsideVertical").style="Continuous",e.format.borders.getItem("InsideHorizontal").style="Continuous")}function B(e,n,t,a){return j.apply(this,arguments)}function j(){return(j=A(h().m(function e(n,t,a,r){var o,i,u,s,c,l,m,d,p,v;return h().w(function(e){for(;;)switch(e.n){case 0:if(a&&0!==a.length){e.n=1;break}return e.a(2,r);case 1:for(o=r,(i=n.getRangeByIndexes(o,0,1,1)).values=[[t]],i.format.font.bold=!0,i.format.fill.color="#ADD8E6",x(i,!1),o++,u=Math.max(0,Math.max.apply(Math,f(a.map(function(e){return e.length})))-1),(s=n.getRangeByIndexes(o,0,a.length,u+1)).values=a,x(s),a.length>0&&(n.getRangeByIndexes(o,0,1,u+1).format.font.bold=!0),u>=6&&(c=u-1,(l=n.getRangeByIndexes(o,c,a.length,1)).format.wrapText=!0,l.format.columnWidth=400,l.format.verticalAlignment="Top",m=u,(d=n.getRangeByIndexes(o,m,a.length,1)).format.wrapText=!0,d.format.columnWidth=400,d.format.verticalAlignment="Top"),p=0;p<=Math.min(u-2,u);p++)(v=n.getRangeByIndexes(o,p,a.length,1)).format.autofitColumns(),v.format.verticalAlignment="Top";return e.a(2,o+a.length+1)}},e)}))).apply(this,arguments)}function R(e,n){var t=document.getElementById("status");t&&(t.textContent=e,t.className="status ".concat(n))}Office.onReady(function(){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("load-partners").onclick=O,document.getElementById("partner-select").onchange=T,document.getElementById("load-remuneration").onclick=D,O()})}(),new URL(t(58394),t.b)}();
//# sourceMappingURL=taskpane.js.map