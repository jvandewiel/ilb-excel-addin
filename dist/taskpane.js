/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,n,t){e.exports=t.p+"30d2e576e940c141feae.css"}},n={};function t(a){var o=n[a];if(void 0!==o)return o.exports;var r=n[a]={exports:{}};return e[a](r,r.exports,t),r.exports}t.m=e,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var a=n.getElementsByTagName("script");if(a.length)for(var o=a.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=a[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e}(),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(){var e,a,o="function"==typeof Symbol?Symbol:{},r=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function u(n,o,r,i){var u=o&&o.prototype instanceof s?o:s,l=Object.create(u.prototype);return t(l,"_invoke",function(n,t,o){var r,i,u,s=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return r=n,i=0,u=e,f.n=t,c}};function m(n,t){for(i=n,u=t,a=0;!d&&s&&!o&&a<l.length;a++){var o,r=l[a],m=f.p,v=r[2];n>3?(o=v===t)&&(u=r[(i=r[4])?5:(i=3,3)],r[4]=r[5]=e):r[0]<=m&&((o=n<2&&m<r[1])?(i=0,f.v=t,f.n=r[1]):m<v&&(o=n<3||r[0]>t||t>v)&&(r[4]=n,r[5]=t,f.n=v,i=0))}if(o||n>1)return c;throw d=!0,t}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,v),i=l,u=v;(a=i<2?e:u)||!d;){r||(i?i<3?(i>1&&(f.n=-1),m(i,u)):f.n=u:f.v=u);try{if(s=2,r){if(i||(o="next"),a=r[o]){if(!(a=a.call(r,u)))throw TypeError("iterator result is not an object");if(!a.done)return a;u=a.value,i<2&&(i=0)}else 1===i&&(a=r.return)&&a.call(r),i<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),i=1);r=e}else if((a=(d=f.n<0)?u:n.call(t,f))!==c)break}catch(n){r=e,i=1,u=n}finally{s=1}}return{value:a,done:d}}}(n,r,i),!0),l}var c={};function s(){}function l(){}function d(){}a=Object.getPrototypeOf;var f=[][r]?a(a([][r]())):(t(a={},r,function(){return this}),a),m=d.prototype=s.prototype=Object.create(f);function v(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,i,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=d,t(m,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,i,"GeneratorFunction"),t(m),t(m,i,"Generator"),t(m,r,function(){return this}),t(m,"toString",function(){return"[object Generator]"}),(n=function(){return{w:u,m:v}})()}function t(e,n,a,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}t=function(e,n,a,o){function i(n,a){t(e,n,function(e){return this._invoke(n,a,e)})}n?r?r(e,n,{value:a,enumerable:!o,configurable:!o,writable:!o}):e[n]=a:(i("next",0),i("throw",1),i("return",2))},t(e,n,a,o)}function a(e,n,t,a,o,r,i){try{var u=e[r](i),c=u.value}catch(e){return void t(e)}u.done?n(c):Promise.resolve(c).then(a,o)}function o(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,i(a.key),a)}}function r(e,n,t){return(n=i(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(n){var t=function(n){if("object"!=e(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var a=t.call(n,"string");if("object"!=e(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==e(t)?t:t+""}var u=function(){return e=function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),r(this,"remunerationData",[]),r(this,"isLoaded",!1)},t=[{key:"loadData",value:(i=n().m(function e(){var t,a;return n().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!this.isLoaded){e.n=1;break}return e.a(2);case 1:return e.p=1,console.log("Loading remuneration data from JSON file..."),e.n=2,fetch("./assets/renumerations-export.json");case 2:if((t=e.v).ok){e.n=3;break}throw new Error("Failed to load data: ".concat(t.status," ").concat(t.statusText));case 3:return e.n=4,t.json();case 4:this.remunerationData=e.v,this.isLoaded=!0,console.log("Loaded ".concat(this.remunerationData.length," remuneration records")),e.n=6;break;case 5:throw e.p=5,a=e.v,console.error("Error loading remuneration data:",a),new Error("Failed to load remuneration data: ".concat(a.message));case 6:return e.a(2)}},e,this,[[1,5]])}),u=function(){var e=this,n=arguments;return new Promise(function(t,o){var r=i.apply(e,n);function u(e){a(r,t,o,u,c,"next",e)}function c(e){a(r,t,o,u,c,"throw",e)}u(void 0)})},function(){return u.apply(this,arguments)})},{key:"getPartners",value:function(){if(!this.isLoaded)return console.warn("Data not loaded yet. Call loadData() first."),[];var e=new Map;this.remunerationData.forEach(function(n){n.company&&n.company.id&&n.company.businessName&&e.set(n.company.id,{id:n.company.id,businessName:n.company.businessName})});var n=Array.from(e.values());return console.log("Found ".concat(n.length," unique partners")),n.sort(function(e,n){return e.businessName.localeCompare(n.businessName)})}},{key:"getPartnerRemuneration",value:function(e){if(!this.isLoaded)return console.warn("Data not loaded yet. Call loadData() first."),[];var n=this.remunerationData.filter(function(n){return n.company&&n.company.id===e});return console.log("Found ".concat(n.length," remuneration records for partner: ").concat(e)),n}},{key:"generateMetadata",value:function(e){var n=this.getPartnerRemuneration(e);if(!n||0===n.length)return[["Metadata","",""],["Partner Name","No data available",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""],["","",""]];var t=n[0],a=t.company,o=t.workingHours;return[["ILB Remuneration Data","",""],["Partner Name",(null==a?void 0:a.businessName)||"Unknown",""],["Commerce Number",(null==a?void 0:a.commerceNumber)||"N/A",""],["Version","".concat(t.lenderVersion,"/").concat(t.totalVersions),""],["Start Date",t.startDate||"N/A",""],["Publish Date",t.publishDate||"N/A",""],["Full Time Hours",(null==o?void 0:o.fullTimeHours)||"N/A",(null==o?void 0:o.fullTimeHoursPer)||""],["Working Hours Comments",(null==o?void 0:o.workingHoursComments)||"N/A",""],["","",""],["Remuneration Components:","",""]]}},{key:"generateHolidayAllowances",value:function(e){var n=this.getPartnerRemuneration(e),t=["No holiday allowances data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Allowance Name","Amount","Amount Type","Interval","Based On","ICB","Conditions","Description"]),n.forEach(function(e){e.holidayAllowances&&e.holidayAllowances.length>0&&e.holidayAllowances.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Holiday Allowance",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A",e.basedOn||"N/A",e.isPartOfIndividualChoiceBudget?"true":"false","N/A",e.description||"N/A"])})}),1===a.length&&a.push(t),a}},{key:"generateAllowances",value:function(e){var n=this.getPartnerRemuneration(e),t=["No allowances data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Allowance Name","Amount","Amount Type","Based On","Interval","ICB","Conditions","Description"]),n.forEach(function(e){e.allowances&&e.allowances.hasAllowances&&e.allowances.allowances&&e.allowances.allowances.forEach(function(e){var n=e.name||e.typeTitle||"Unnamed Allowance";e.allowanceComponents&&e.allowanceComponents.length>0?e.allowanceComponents.forEach(function(e){var t,o,r=e.amount?"".concat(e.amount).concat("Percentage"===(null===(t=e.amountType)||void 0===t?void 0:t.value)?"%":""):"N/A";a.push([n,r,(null===(o=e.amountType)||void 0===o?void 0:o.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","false",e.conditions||"N/A",e.description||"N/A"])}):a.push([n,"N/A","N/A","N/A","N/A","false",e.conditions||"N/A","No components available"])})}),1===a.length&&a.push(t),console.log(a),a}},{key:"generatePensionData",value:function(e){var n=this.getPartnerRemuneration(e),t=["No pension data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Component Name","Amount","Amount Type","Based On","Interval","ICB","Conditions","Description"]),n.forEach(function(e){e.pensionData&&e.pensionData.hasPension&&e.pensionData.items&&e.pensionData.items.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Pension",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","false","N/A",e.description||"N/A"])})}),1===a.length&&a.push(t),a}},{key:"generateLeaveData",value:function(e){var n=this.getPartnerRemuneration(e),t=["No leave data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Leave Type","Amount","Amount Type","Interval","Based On","ICB","Conditions","Description"]),n.forEach(function(e){if(e.leave){var n=e.leave;n.hasWorkingHoursReduction&&n.workingHoursReductions&&n.workingHoursReductions.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Working Hours Reduction",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"false",e.conditions||"N/A",e.description||"N/A"])}),n.hasVacationDays&&n.vacationDays&&n.vacationDays.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Vacation Days",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"false",e.conditions||"N/A",e.description||"N/A"])}),n.hasSpecialLeave&&n.specialLeave&&n.specialLeave.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Special Leave",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"false",e.conditions||"N/A",e.description||"N/A"])}),n.hasAdditionalWAZO&&n.additionalWAZO&&n.additionalWAZO.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Additional WAZO",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"false",e.conditions||"N/A",e.description||"N/A"])}),n.hasMandatoryLeave&&n.mandatoryLeave&&n.mandatoryLeave.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Mandatory Leave",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.interval||"N/A","",e.isPartOfIndividualChoiceBudget?"true":"false",e.conditions||"N/A",e.description||"N/A"])})}}),1===a.length&&a.push(t),a}},{key:"generateSickPayData",value:function(e){var n=this.getPartnerRemuneration(e),t=["No sick pay data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Component Name","Amount","Amount Type","Based On","Interval","ICB","Conditions","Description"]),n.forEach(function(e){e.sickPay&&e.sickPay.sickPayAmounts&&Array.isArray(e.sickPay.sickPayAmounts)&&e.sickPay.sickPayAmounts.length>0&&e.sickPay.sickPayAmounts.forEach(function(e){var n,t,o,r=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Sick Pay (".concat((null===(t=e.sickPayYear)||void 0===t?void 0:t.value)||"Unknown Year",")"),r,(null===(o=e.amountType)||void 0===o?void 0:o.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","false","N/A","N/A"])})}),1===a.length&&a.push(t),a}},{key:"generateIndividualChoiceBudget",value:function(e){var n=this.getPartnerRemuneration(e),t=["No individual choice budget data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Component Name","Amount","Amount Type","Based On","Interval","ICB","Conditions","Description"]),n.forEach(function(e){if(e.individualChoiceBudget&&e.individualChoiceBudget.hasIndividualChoiceBudget){var n,t,o=e.individualChoiceBudget,r=o.amount?"".concat(o.amount).concat("Percentage"===(null===(n=o.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push(["Individual Choice Budget",r,(null===(t=o.amountType)||void 0===t?void 0:t.value)||"N/A",o.basedOn||"N/A",o.interval||"N/A","true","N/A","Main budget allocation"]),o.items&&o.items.length>0&&o.items.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A",r="Other"===e.name&&e.typeOther?e.typeOther:e.name||"Unnamed Component";a.push([r,o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A",e.isPartOfIndividualChoiceBudget?"true":"false","N/A",e.description||"N/A"])})}}),1===a.length&&a.push(t),a}},{key:"generateReimbursementsData",value:function(e){var n=this.getPartnerRemuneration(e),t=["No reimbursements data available","","","","","","",""];if(!n||0===n.length)return[t];var a=[];return a.push(["Reimbursement Name","Amount","Amount Type","Based On","Interval","ICB","Conditions","Description"]),n.forEach(function(e){e.reimbursementsData&&e.reimbursementsData.hasReimbursements&&e.reimbursementsData.reimbursements&&e.reimbursementsData.reimbursements.forEach(function(e){var n,t,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A";a.push([e.name||"Unnamed Reimbursement",o,(null===(t=e.amountType)||void 0===t?void 0:t.value)||"N/A",e.basedOn||"N/A",e.interval||"N/A","false",e.conditions||"N/A",e.description||"N/A"])})}),1===a.length&&a.push(t),a}},{key:"generatePaymentsData",value:function(e){var n=this.getPartnerRemuneration(e);if(!n||0===n.length)return[["No payments data available","","","","","","",""]];var t=[];return t.push(["Payment Type","Amount","Amount Type","Based On","Interval","ICB","Conditions","Description"]),n.forEach(function(e){e.paymentsData&&e.paymentsData.hasAnniversaryPayments&&e.paymentsData.anniversaryPayments&&e.paymentsData.anniversaryPayments.forEach(function(e){var n,a,o=e.amount?"".concat(e.amount).concat("Percentage"===(null===(n=e.amountType)||void 0===n?void 0:n.value)?"%":""):"N/A",r="Anniversary Payment (".concat(e.amountOfYears," years)"),i="Other"===e.basedOn&&e.basedOnOther?e.basedOnOther:e.basedOn||"N/A",u="Other"===e.dateOrCondition&&e.dateOrConditionOther?e.dateOrConditionOther:e.dateOrCondition||"N/A";t.push([r,o,(null===(a=e.amountType)||void 0===a?void 0:a.value)||"N/A",i,e.interval||"N/A","false",u,e.description||"N/A"])})}),1===t.length&&t.push(["No payments data found","","","","","","",""]),t}}],t&&o(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i,u}(),c=new u;function s(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=d(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i=!0,u=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return i=e.done,e},e:function(e){u=!0,r=e},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw r}}}}function d(e,n){if(e){if("string"==typeof e)return f(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?f(e,n):void 0}}function f(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,a=Array(n);t<n;t++)a[t]=e[t];return a}function m(){var e,n,t="function"==typeof Symbol?Symbol:{},a=t.iterator||"@@iterator",o=t.toStringTag||"@@toStringTag";function r(t,a,o,r){var c=a&&a.prototype instanceof u?a:u,s=Object.create(c.prototype);return v(s,"_invoke",function(t,a,o){var r,u,c,s=0,l=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(n,t){return r=n,u=0,c=e,f.n=t,i}};function m(t,a){for(u=t,c=a,n=0;!d&&s&&!o&&n<l.length;n++){var o,r=l[n],m=f.p,v=r[2];t>3?(o=v===a)&&(c=r[(u=r[4])?5:(u=3,3)],r[4]=r[5]=e):r[0]<=m&&((o=t<2&&m<r[1])?(u=0,f.v=a,f.n=r[1]):m<v&&(o=t<3||r[0]>a||a>v)&&(r[4]=t,r[5]=a,f.n=v,u=0))}if(o||t>1)return i;throw d=!0,a}return function(o,l,v){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&m(l,v),u=l,c=v;(n=u<2?e:c)||!d;){r||(u?u<3?(u>1&&(f.n=-1),m(u,c)):f.n=c:f.v=c);try{if(s=2,r){if(u||(o="next"),n=r[o]){if(!(n=n.call(r,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,u<2&&(u=0)}else 1===u&&(n=r.return)&&n.call(r),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);r=e}else if((n=(d=f.n<0)?c:t.call(a,f))!==i)break}catch(n){r=e,u=1,c=n}finally{s=1}}return{value:n,done:d}}}(t,o,r),!0),s}var i={};function u(){}function c(){}function s(){}n=Object.getPrototypeOf;var l=[][a]?n(n([][a]())):(v(n={},a,function(){return this}),n),d=s.prototype=u.prototype=Object.create(l);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,v(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=s,v(d,"constructor",s),v(s,"constructor",c),c.displayName="GeneratorFunction",v(s,o,"GeneratorFunction"),v(d),v(d,o,"Generator"),v(d,a,function(){return this}),v(d,"toString",function(){return"[object Generator]"}),(m=function(){return{w:r,m:f}})()}function v(e,n,t,a){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}v=function(e,n,t,a){function r(n,t){v(e,n,function(e){return this._invoke(n,t,e)})}n?o?o(e,n,{value:t,enumerable:!a,configurable:!a,writable:!a}):e[n]=t:(r("next",0),r("throw",1),r("return",2))},v(e,n,t,a)}function p(e,n,t,a,o,r,i){try{var u=e[r](i),c=u.value}catch(e){return void t(e)}u.done?n(c):Promise.resolve(c).then(a,o)}function y(e){return function(){var n=this,t=arguments;return new Promise(function(a,o){var r=e.apply(n,t);function i(e){p(r,a,o,i,u,"next",e)}function u(e){p(r,a,o,i,u,"throw",e)}i(void 0)})}}var h=[],g="";function b(){return A.apply(this,arguments)}function A(){return(A=y(m().m(function e(){var n,t;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:return console.log("Starting to load partners..."),D("Loading partners from JSON data...","loading"),e.p=1,e.n=2,c.loadData();case 2:h=c.getPartners(),console.log("Partners loaded:",h),(n=document.getElementById("partner-select"))&&(n.innerHTML='<option value="">Select a partner...</option>',h.forEach(function(e){console.log("Adding partner to dropdown:",e);var t=document.createElement("option");t.value=e.id,t.textContent=e.businessName,n.appendChild(t)}),n.disabled=!1),D("Loaded ".concat(h.length," partners"),"success"),e.n=4;break;case 3:e.p=3,t=e.v,console.error("Error loading partners:",t),D("Error loading partners: ".concat(t.message),"error");case 4:return e.a(2)}},e,null,[[1,3]])}))).apply(this,arguments)}function N(){var e=document.getElementById("partner-select");if(e){g=e.value;var n=document.getElementById("load-remuneration");if(n&&(g?n.classList.remove("disabled"):n.classList.add("disabled")),g){var t=h.find(function(e){return e.id===g});D("Selected partner: ".concat((null==t?void 0:t.businessName)||g),"success")}else D("Select a partner to continue","loading")}}function w(){return P.apply(this,arguments)}function P(){return P=y(m().m(function e(){var n,t,a,o;return m().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!(n=document.getElementById("load-remuneration"))||!n.classList.contains("disabled")){e.n=1;break}return e.a(2);case 1:if(g){e.n=2;break}return D("Please select a partner first","error"),e.a(2);case 2:if(t=h.find(function(e){return e.id===g}),D("Loading remuneration and allowances for ".concat(null==t?void 0:t.businessName,"..."),"loading"),e.p=3,(a=c.getPartnerRemuneration(g))&&0!==a.length){e.n=4;break}return D("No remuneration available for this partner","error"),e.a(2);case 4:return e.n=5,Excel.run(function(){var e=y(m().m(function e(n){return m().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,k(n,g,(null==t?void 0:t.businessName)||"Unknown");case 1:D("Remuneration and allowances loaded successfully for ".concat(null==t?void 0:t.businessName," (").concat(a.length," records)"),"success");case 2:return e.a(2)}},e)}));return function(n){return e.apply(this,arguments)}}());case 5:e.n=7;break;case 6:e.p=6,o=e.v,console.error("Error loading remuneration:",o),D("Error loading remuneration: ".concat(o.message),"error");case 7:return e.a(2)}},e,null,[[3,6]])})),P.apply(this,arguments)}function k(e,n,t){return O.apply(this,arguments)}function O(){return(O=y(m().m(function e(n,t,a){var o,r,i,u,s,l,d,f,v,p,y,h,g,b,A,N;return m().w(function(e){for(;;)switch(e.n){case 0:return console.log("Preparing to load data into ILB sheet for partner ID: ".concat(t)),(r=n.workbook.worksheets).load("items/name"),e.n=1,n.sync();case 1:if(!(i=r.items.find(function(e){return"ILB"===e.name}))){e.n=2;break}o=i,e.n=3;break;case 2:return console.log("ILB worksheet not found, creating a new one."),o=r.add("ILB"),e.n=3,n.sync();case 3:return console.log("Clearing existing data in ILB sheet..."),e.n=4,C(n);case 4:return(u=o.getUsedRange()).load("address"),e.n=5,n.sync();case 5:if("A1:A1"===u.address&&""===u.values[0][0]){e.n=6;break}return u.clear(),e.n=6,n.sync();case 6:return console.log("Loading data for partner: ".concat(a," into ILB sheet")),s=c.generateMetadata(t),console.log("Metadata generated:",s),(l=o.getRange("A1:C10")).values=s,l.format.font.bold=!0,l.getColumn(0).format.fill.color="#E3F2FD",I(l,!1),d=o.getRange("B7"),n.workbook.names.add("WorkingHoursPerWeek",d),e.n=7,n.sync();case 7:if(f=11,v=c.generateHolidayAllowances(t),console.log("Holiday Allowances Data:",v),!(v.length>0)){e.n=9;break}return e.n=8,B(o,"Holiday Allowances",v,f);case 8:f=e.v;case 9:if(!((p=c.generateLeaveData(t)).length>0)){e.n=11;break}return e.n=10,B(o,"Leave",p,f);case 10:f=e.v;case 11:if(!((y=c.generateIndividualChoiceBudget(t)).length>0)){e.n=13;break}return e.n=12,B(o,"Individual Choice Budget",y,f);case 12:f=e.v;case 13:if(!((h=c.generatePensionData(t)).length>0)){e.n=15;break}return e.n=14,B(o,"Pension",h,f);case 14:f=e.v;case 15:if(!((g=c.generateSickPayData(t)).length>0)){e.n=17;break}return e.n=16,B(o,"Sick Pay",g,f);case 16:f=e.v;case 17:if(!((b=c.generateAllowances(t)).length>0)){e.n=19;break}return e.n=18,B(o,"Allowances",b,f);case 18:f=e.v;case 19:if(!((A=c.generateReimbursementsData(t)).length>0)){e.n=21;break}return e.n=20,B(o,"Reimbursements",A,f);case 20:f=e.v;case 21:if(!((N=c.generatePaymentsData(t)).length>0)){e.n=23;break}return e.n=22,B(o,"Payments",N,f);case 22:f=e.v;case 23:return o.getUsedRange().format.autofitColumns(),o.getRange("B:B").format.columnWidth=100,o.getCell(7,1).format.wrapText=!1,o.getRange("C:F").format.columnWidth=100,e.n=24,n.sync();case 24:console.log("Data loaded successfully into ILB sheet for ".concat(a));case 25:return e.a(2)}},e)}))).apply(this,arguments)}function C(e){return T.apply(this,arguments)}function T(){return(T=y(m().m(function e(n){var t,a,o,r,i;return m().w(function(e){for(;;)switch(e.n){case 0:return console.log("Clearing existing named ranges..."),(t=n.workbook.names).load("items"),e.n=1,n.sync();case 1:a=t.items.slice(),o=l(a);try{for(o.s();!(r=o.n()).done;)i=r.value,console.log("Deleting named range: ".concat(i.name)),i.delete()}catch(e){o.e(e)}finally{o.f()}if(!(a.length>0)){e.n=3;break}return e.n=2,n.sync();case 2:console.log("Cleared ".concat(a.length," existing named ranges")),e.n=4;break;case 3:console.log("No existing named ranges to clear");case 4:return e.a(2)}},e)}))).apply(this,arguments)}function I(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.format.borders.getItem("EdgeTop").style="Continuous",e.format.borders.getItem("EdgeBottom").style="Continuous",e.format.borders.getItem("EdgeLeft").style="Continuous",e.format.borders.getItem("EdgeRight").style="Continuous",n&&(e.format.borders.getItem("InsideVertical").style="Continuous",e.format.borders.getItem("InsideHorizontal").style="Continuous")}function B(e,n,t,a){return E.apply(this,arguments)}function E(){return(E=y(m().m(function e(n,t,a,o){var r,i,u,c,l,d,f,v,p,y;return m().w(function(e){for(;;)switch(e.n){case 0:if(a&&0!==a.length){e.n=1;break}return e.a(2,o);case 1:for(r=o,(i=n.getRangeByIndexes(r,0,1,1)).values=[[t]],i.format.font.bold=!0,i.format.fill.color="#ADD8E6",I(i,!1),r++,u=Math.max(0,Math.max.apply(Math,s(a.map(function(e){return e.length})))-1),(c=n.getRangeByIndexes(r,0,a.length,u+1)).values=a,I(c),a.length>0&&(n.getRangeByIndexes(r,0,1,u+1).format.font.bold=!0),u>=6&&(l=u-1,(d=n.getRangeByIndexes(r,l,a.length,1)).format.wrapText=!0,d.format.columnWidth=400,d.format.verticalAlignment="Top",f=u,(v=n.getRangeByIndexes(r,f,a.length,1)).format.wrapText=!0,v.format.columnWidth=400,v.format.verticalAlignment="Top"),p=0;p<=Math.min(u-2,u);p++)(y=n.getRangeByIndexes(r,p,a.length,1)).format.autofitColumns(),y.format.verticalAlignment="Top";return e.a(2,r+a.length+1)}},e)}))).apply(this,arguments)}function D(e,n){var t=document.getElementById("status");t&&(t.textContent=e,t.className="status ".concat(n))}Office.onReady(function(){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("load-partners").onclick=b,document.getElementById("partner-select").onchange=N,document.getElementById("load-remuneration").onclick=w,b()})}(),new URL(t(58394),t.b)}();
//# sourceMappingURL=taskpane.js.map